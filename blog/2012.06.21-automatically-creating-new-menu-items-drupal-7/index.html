<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="The blog of Kenny Robinson">
  <meta name="author" content="Kenny Robinson, @almostengr">
  <meta name="generator" content="Mkdocs">

  
  <title>Automatically creating new menu items Drupal 7 - The Almost Engineer</title>
  

  <link href="/assets/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/blog.min.css" rel="stylesheet">

  <meta property="og:type" content="website" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="The Almost Engineer" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="" />
  <meta name="twitter:creator" content="" />

  
  <meta name="description" content="The blog of Kenny Robinson">
  <meta property="og:description" content="The blog of Kenny Robinson" />
  <meta name="twitter:description" content="The blog of Kenny Robinson" />
  

  

  

  

  
  <meta name="robots" content="index, follow" />
  

  
  <link rel="canonical" href="https://thealmostengineer.com/blog/2012.06.21-automatically-creating-new-menu-items-drupal-7/">
  <meta property="og:url" content="https://thealmostengineer.com/blog/2012.06.21-automatically-creating-new-menu-items-drupal-7/" />
  <meta property="twitter:url" content="https://thealmostengineer.com/blog/2012.06.21-automatically-creating-new-menu-items-drupal-7/" />
  

  
  <meta name="author" content="Kenny Robinson, @almostengr">
  

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="//www.googletagmanager.com/gtag/js?id="></script>
  <script
    async>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-64643711-1');</script>
</head>

<body class="bg-dark">
  <nav class="navbar navbar-expand-md navbar-dark bg-dark pb-2">
    <a class="navbar-brand" href="/">The Almost Engineer</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item"><a class="nav-link text-light" href="/blog">Blog</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="/projects">Projects</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="/resources">Get Into Tech</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="https://lightshow.thealmostengineer.com">Light Show</a></li>
      </ul>

      
      <form class="form-inline mt-2 mt-md-0" action="https://www.google.com/search" method="get">
        <input type="hidden" name="q" value="site:thealmostengineer.com">
        <input class="form-control mr-sm-2" type="text" placeholder="Search with Google" aria-label="Search" name="q">
      </form>
      
    </div>
  </nav>

  <div class="bg-light pt-3 mb-0 pb-0">
    

    
    <main role="main" class="container">
  <div class="row">
    <div class="col-md-8 blog-main">
      
      
      
      <h1 id="automatically-creating-new-menu-items-drupal-7">Automatically creating new menu items Drupal 7</h1>
<h2 id="menu-breadcrumbs">Menu breadcrumbs</h2>
<p>Drupal breadcrumbs implementation is a never-ending source of 
frustration for many website developers. A few modules exist which more 
or less successfully attempt to get Drupal to display meaningful 
breadcrumbs on every page.</p>
<p>One of these modules is <a href="http://drupal.org/projects/menu_breadcrumb">menu_breadcrumb</a>, which displays the breadcrumb trail based on current node's menu path. Very useful and sufficient in most use cases.</p>
<h2 id="limitations-and-automatic-menu-modules">Limitations and automatic menu modules</h2>
<p>The only problem with <em>menu_breadcrumb</em> is when you're not happy to grant users the <em>administer menu</em> permission to create and assign menu items for the content they create.</p>
<p>Several Drupal modules exist which work around the permission 
restriction and automatically create menu items for newly created 
content nodes. To name a few, <a href="http://drupal.org/projects/automenu">Auto Menu</a> and <a href="http://drupal.org/projects/automaticmenu">Automatic Menu</a>, both of which are either only available for Drupal 5.x, or their Drupal 6.x implementation is still in beta development stage.</p>
<h2 id="rules-and-drupal-api">Rules and Drupal API</h2>
<p>Fortunately, a quick and easy way to create menu items 
programmatically doesn't even require a standalone module. All we're 
going to need is the <a href="http://drupal.org/projects/rules">Rules</a> module and a bit of Drupal API knowledge.</p>
<p>The Rules set of modules allows site administrators to define 
conditionally executed actions, such as arbitrary PHP code execution, 
based on occurring events, such as node creation. For the Drupal API 
part, we'll use a single function <a href="http://api.drupal.org/api/function/menu_link_save">menu_link_save</a>.</p>
<p><em>menu_link_save</em> requires an item configuration parameter, whose key names mirror the column names of Drupal's <em>menu_links</em> database table.</p>
<h2 id="the-solution">The solution</h2>
<p>As mentioned above, we're going to use the <em>Rules</em> module. 
It's installation is pretty straightforward and requires no additional 
configuration. Let's move right to the setting up our rule.</p>
<p>Say we want to create a menu item under <em>Primary Links</em> menu's <em>Blog</em> item every time a new node of type <em>Story</em> is created.</p>
<p>Navigate your browser to <em>Administer » Rules » Triggered rules</em> page, add a new rule and configure it along the lines of the image:</p>
<p><img alt="Screen-shot of Drupal Rules' configuration screen of a rule which would execute custom PHP code at each creation of a node of type Story" src="http://jan.tomka.name/sites/default/files/rules_auto_menu.jpg" /></p>
<p>Finally, we're getting to the PHP snippet itself, which we'll use to 
automatically create a new menu item every time this rule is triggered. 
Click <em>Execute custom PHP code</em> and insert the following fragment of code:</p>
<pre><code class="language-php">$item = array(
  'link_path' =&gt; 'node/' . $node-&gt;nid,
  'link_title' =&gt; $node-&gt;title,
  'plid' =&gt; 426,
  'hidden' =&gt; 1
);
menu_link_save($item);
</code></pre>
<p>Just a few remarks on otherwise pretty simple piece of code.</p>
<ul>
<li><em>menu_link_save</em> function will only accept normalized path as
 a link path. When using anything nontrivial for the path, such as the 
loaded node's <em>path</em> property, always use drupal_get_normal_path()  to normalize its value!</li>
<li><em>menu_name</em> is the the machine-readable name of the menu. You can get that from <em>Administer » Site building » Menus</em> page as the last component of the menu customization URL.</li>
<li>Value of <em>plid</em> is the menu link id of the item you want your
 item to be a child of. Again, easy to find out, just navigate your 
browser to the menu's <em>List items</em> page and figure out the menu link id of each menu item from its <em>edit</em> link URL.</li>
<li>It's up to you whether you want the menu item hidden or displayed by
 default. I'm using the automatically created menu items just to give <em>menu_breadcrumb</em>
 a when putting together the current page's breadcrumb trail. I don't 
want the menu items to be visible to the users, that's why i set the <em>hidden</em> value to 1.</li>
</ul>
<p>Source: http://jan.tomka.name/blog/programmatically-creating-menu-items-drupal</p>

      

      <div class="text-muted py-2">
        
        <span>Updated: 2020-07-15 |</span>
        

        
        <span>Posted: 2012-06-21</span>
        
      </div>
      <div class="text-muted pb-2">
        
      </div>

      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4218270188842097" data-ad-slot="5189305512" data-ad-format="auto"
        data-full-width-responsive="true"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div><!-- /.blog-main -->

    <aside class="col-md-4 blog-sidebar">
      <div class="p-4 mb-3 bg-light rounded shadow">
        <h4 class="font-italic">About Kenny</h4>
        <p class="mb-0">
          A software developer that builds and fixes things, and writes about the journey.
        </p>
      </div>
      <div class="p-4 shadow mb-3">
        <h4 class="font-italic">Get Into Tech</h4>
        <p class="mb-0">
          Are you looking to get into a tech career or role? Check out the
          <a href="/resources">Resources</a> section for more information. Also check out my
          <a href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1" target="_blank">
            Tech Talk YouTube Channel</a> and
          <a href="https://www.facebook.com/profile.php?id=100089303142244" target="_blank">
            Tech Talk Facebook page</a> for video tutorials about software development, web development,
          and working with tech.
          </a>
        </p>
      </div>
      <div class="p-4 shadow mb-3">
        <h4 class="font-italic">Connect with Me</h4>
        <ol class="list-unstyled">
          <li><a target="_blank" href="https://bluesky.com/almostengr.bsky.social">Blue Sky</a></li>
          <li><a target="_blank" href="https://www.fanbase.app/almostengr">Fanbase</a></li>
          <li><a target="_blank" href="https://github.com/almostengr">Github</a></li>
          <li><a target="_blank" href="https://facebook.com/rhtservicesllc">Home Improvement (Facebook)</a></li>
          <li><a target="_blank" href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home
              Improvement (YouTube)</a></li>
          <li><a target="_blank" href="https://instagram.com/almostengr">Instagram</a></li>
          <li><a target="_blank" href="https://www.youtube.com/channel/UCB7rvymUaUbbig3skv2zvCQ?sub_confirmation=1">Kenny Ram Dash Cam</a></li>
          <li><a target="_blank" href="https://stackoverflow.com/users/12875554/almostengr">StackOverflow</a></li>
          <li><a target="_blank" href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a></li>
          <li><a target="_blank" href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk
              (YouTube)</a></li>
          <li><a target="_blank" href="https://www.tiktok.com/@almostengr">TikTok</a></li>
          <li><a target="_blank" href="https://twitter.com/almostengr">Twitter</a></li>
        </ol>
      </div>
      <div class="p-4 shadow mb-3">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4218270188842097" data-ad-slot="5189305512" data-ad-format="auto"
          data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>
    </aside><!-- /.blog-sidebar -->
  </div><!-- /.row -->
</main><!-- /.container -->
<footer class="blog-footer bg-dark text-light text-left">
  <div class="container">
    <div>
      <a class="text-light pr-2" href="/blog">Blog</a>
      <a class="text-light pr-2" href="/projects">Projects</a>
      <a class="text-light pr-2" href="/resources">Get Into Tech</a>
      <a class="text-light pr-2" href="/services">Services</a>
      <a class="text-light pr-2" href="/blog">Food</a>
      <a class="text-light pr-2" href="/uses">Uses</a>
      <a class="text-light pr-2" href="/about">About</a>
      <a class="text-light pr-2" href="/contact">Contact</a>
      <a class="text-light pr-2" href="/privacy">Privacy Policy</a>
      <a class="text-light pr-2" href="/sitemap.xml">Sitemap</a>
    </div>
    <div>
      <a class="text-light pr-2" target="_blank" href="https://facebook.com/rhtservicesllc">Home Improvement (Facebook)</a>
      <a class="text-light pr-2" target="_blank" href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home
        Improvement (YouTube)</a>
      <a class="text-light pr-2" target="_blank" href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a>
      <a class="text-light pr-2" target="_blank" href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk
        (YouTube)</a>
      <a class="text-light pr-2" target="_blank" href="https://www.youtube.com/channel/UCB7rvymUaUbbig3skv2zvCQ?sub_confirmation=1">Kenny Ram Dash
        Cam</a>
    </div>
    <div>
      <a class="text-light pr-2" target="_blank" href="https://bluesky.com/almostengr.bsky.social">Blue Sky</a>
      <a class="text-light pr-2" target="_blank" href="https://fanbase.app/almostengr">Fanbase</a>
      <a class="text-light pr-2" target="_blank" href="https://github.com/almostengr">Github</a>
      <a class="text-light pr-2" target="_blank" href="https://instagram.com/almostengr">Instagram</a>
      <a class="text-light pr-2" target="_blank" href="https://stackoverflow.com/users/12875554/almostengr">StackOverflow</a>
      <a class="text-light pr-2" target="_blank" href="https://www.tiktok.com/@almostengr">TikTok</a>
      <a class="text-light pr-2" target="_blank" href="https://twitter.com/almostengr">Twitter</a>
    </div>
    <div>Copyright &copy; 2010-2025 Kenny Robinson</div>
    <div>
      Created by <a class="text-light" href="https://rhtservices.net" target="_blank">Robinson Handy and Technology Services</a>
    </div>
    <div>
      Disclaimer: The opinions expressed here are those of mine and not representative of my employer or
      affiliates.
    </div>
  </div>
</footer>
    

  </div>
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <script type="text/javascript" src="/js/popper.min.js"></script>
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
</body>

</html>