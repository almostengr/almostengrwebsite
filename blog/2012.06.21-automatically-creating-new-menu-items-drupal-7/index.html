<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0, shrink-to-fit=no"><meta property=og:locale content=en_US><meta property=og:site_name content="Almost Engineer Services"><meta name=description content="The blog of Kenny Robinson where he shares his thoughts and experiences."><meta property=og:description content="The blog of Kenny Robinson where he shares his thoughts and experiences."><meta name=twitter:description content="The blog of Kenny Robinson where he shares his thoughts and experiences."><meta name=author content="Kenny Robinson, @almostengr"><title>Automatically creating new menu items Drupal 7 | Almost Engineer Services</title><meta property=og:title content="Automatically creating new menu items Drupal 7"><meta name=twitter:title content="Automatically creating new menu items Drupal 7"><meta property=og:type content=website><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/blog/2012.06.21-automatically-creating-new-menu-items-drupal-7/ rel=canonical><meta content=https://thealmostengineer.com/blog/2012.06.21-automatically-creating-new-menu-items-drupal-7/ property=og:url><script>
(function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
    (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
    m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-64643711-1', 'thealmostengineer.com');
ga('send', 'pageview');
</script><script async src=https://kit.fontawesome.com/a076d05399.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><!-- Bootstrap core CSS --><link href=/css/bootstrap.min.css rel=stylesheet><link href=/css/almostengrtheme.min.css rel=stylesheet><!-- other styles --><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/default.min.css><link href=/css/a11y-dark-theme.min.css rel=stylesheet><style>
    .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }
    @media (min-width: 768px) {
        .bd-placeholder-img-lg {
            font-size: 3.5rem;
        }
    }
</style><!-- Custom styles for by page --><link href=/css/navbar-top-fixed.min.css rel=stylesheet><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest></head> <body> <header> <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-black"> <div> <a href=/ class="navbar-brand font-weight-bold">Almost Engineer Services</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav ml-auto"> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/about#handyman-services>Handyman</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/about#technology-services>Technical</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/blog>Blog</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/uses>Uses</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/contact>Contact</a> </li> </ul> <form class="mt-2 mt-md-0" method=GET action=/request> <button class="btn btn-outline-danger mx-2 text-uppercase" type=submit>Request Service</button> </form> </div> </nav> </header> <main role=main class="container py-2"> <div class=row> <div id=content-area class="col-sm-12 col-lg-8 border-lg-right border-dark"> <article> <div class="p-1 font-italic text-small rounded"> <strong>Updated:</strong> 2020-07-15 </div> <h1 id=automatically-creating-new-menu-items-drupal-7>Automatically creating new menu items Drupal 7</h1> <h2 id=menu-breadcrumbs>Menu breadcrumbs</h2> <p>Drupal breadcrumbs implementation is a never-ending source of frustration for many website developers. A few modules exist which more or less successfully attempt to get Drupal to display meaningful breadcrumbs on every page.</p> <p>One of these modules is <a href=http://drupal.org/project/menu_breadcrumb>menu_breadcrumb</a>, which displays the breadcrumb trail based on current node's menu path. Very useful and sufficient in most use cases.</p> <h2 id=limitations-and-automatic-menu-modules>Limitations and automatic menu modules</h2> <p>The only problem with <em>menu_breadcrumb</em> is when you're not happy to grant users the <em>administer menu</em> permission to create and assign menu items for the content they create.</p> <p>Several Drupal modules exist which work around the permission restriction and automatically create menu items for newly created content nodes. To name a few, <a href=http://drupal.org/project/automenu>Auto Menu</a> and <a href=http://drupal.org/project/automaticmenu>Automatic Menu</a>, both of which are either only available for Drupal 5.x, or their Drupal 6.x implementation is still in beta development stage.</p> <h2 id=rules-and-drupal-api>Rules and Drupal API</h2> <p>Fortunately, a quick and easy way to create menu items programmatically doesn't even require a standalone module. All we're going to need is the <a href=http://drupal.org/project/rules>Rules</a> module and a bit of Drupal API knowledge.</p> <p>The Rules set of modules allows site administrators to define conditionally executed actions, such as arbitrary PHP code execution, based on occurring events, such as node creation. For the Drupal API part, we'll use a single function <a href=http://api.drupal.org/api/function/menu_link_save>menu_link_save</a>.</p> <p><em>menu_link_save</em> requires an item configuration parameter, whose key names mirror the column names of Drupal's <em>menu_links</em> database table.</p> <h2 id=the-solution>The solution</h2> <p>As mentioned above, we're going to use the <em>Rules</em> module. It's installation is pretty straightforward and requires no additional configuration. Let's move right to the setting up our rule.</p> <p>Say we want to create a menu item under <em>Primary Links</em> menu's <em>Blog</em> item every time a new node of type <em>Story</em> is created.</p> <p>Navigate your browser to <em>Administer » Rules » Triggered rules</em> page, add a new rule and configure it along the lines of the image:</p> <p><img alt="Screen-shot of Drupal Rules' configuration screen of a rule which would execute custom PHP code at each creation of a node of type Story" src=http://jan.tomka.name/sites/default/files/rules_auto_menu.jpg></p> <p>Finally, we're getting to the PHP snippet itself, which we'll use to automatically create a new menu item every time this rule is triggered. Click <em>Execute custom PHP code</em> and insert the following fragment of code:</p> <pre><code class=php>$item = array(
  'link_path' =&gt; 'node/' . $node-&gt;nid,
  'link_title' =&gt; $node-&gt;title,
  'plid' =&gt; 426,
  'hidden' =&gt; 1
);
menu_link_save($item);
</code></pre> <p>Just a few remarks on otherwise pretty simple piece of code.</p> <ul> <li><em>menu_link_save</em> function will only accept normalized path as a link path. When using anything nontrivial for the path, such as the loaded node's <em>path</em> property, always use drupal_get_normal_path() to normalize its value!</li> <li><em>menu_name</em> is the the machine-readable name of the menu. You can get that from <em>Administer » Site building » Menus</em> page as the last component of the menu customization URL.</li> <li>Value of <em>plid</em> is the menu link id of the item you want your item to be a child of. Again, easy to find out, just navigate your browser to the menu's <em>List items</em> page and figure out the menu link id of each menu item from its <em>edit</em> link URL.</li> <li>It's up to you whether you want the menu item hidden or displayed by default. I'm using the automatically created menu items just to give <em>menu_breadcrumb</em> a when putting together the current page's breadcrumb trail. I don't want the menu items to be visible to the users, that's why i set the <em>hidden</em> value to 1.</li> </ul> <p>Source: http://jan.tomka.name/blog/programmatically-creating-menu-items-drupal</p> <div class="bg-light border border-danger my-3 p-3 rounded"> <strong>Published:</strong> 2012-06-21 <strong>Updated:</strong> 2020-07-15<br> <strong>Category:</strong> technology<br> </div> </article> </div> <!-- sidebar --> <div id=sidebar class="col-sm-12 col-lg-4 p-1"> <div class="mb-3 border border-dark rounded p-2 bg-dark text-gray"> <h4 class="text-left border-bottom border-white"> <span class="bg-white text-dark px-2 font-weight-bold">REQUEST SERVICE</span> </h4> <p>Do you have work that needs to be done and are ready to get started?</p> <p><a class="btn btn-danger" href=/request>GET STARTED!</a></p> </div> <div class="mb-3 border border-dark rounded bg-dark p-2 text-gray"> <h4 class="text-left border-bottom border-white"> <span class="bg-white text-dark px-2 font-weight-bold">BLOG</span> </h4> <p>Check out some of our past projects and work on our <a href=/blog>blog</a>!</p> </div> <div class="mb-3 border border-dark rounded bg-dark p-2"> <h4 class="text-left border-bottom border-white"> <span class="bg-white text-dark px-2 font-weight-bold">SPONSOR</span> </h4> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </div> <!-- end sidebar --> </div> </main> <p class=container><a href=#top class="text-small text-red">Back to Top</a></p> <footer class="bg-black pt-3"> <div class="container px-0"> <div class="text-white col-12"> <ul class="list-unstyled list-inline"> <li class="px-2 bg-white list-inline-item text-dark font-weight-bold">SOCIAL</li> <li class="mr-2 list-inline-item text-capitalize"> <a href=https://github.com/almostengr target=_blank>github</a> </li> <li class="mr-2 list-inline-item text-capitalize"> <a href=https://instagram.com/almostengr target=_blank>instagram</a> </li> <li class="mr-2 list-inline-item text-capitalize"> <a href=https://stackoverflow.com/users/12875554/almostengr target=_blank>stack-overflow</a> </li> <li class="mr-2 list-inline-item text-capitalize"> <a href=https://twitter.com/almostengr target=_blank>twitter</a> </li> <li class="mr-2 list-inline-item text-capitalize"> <a href="https://www.youtube.com/channel/UC4HCouBLtXD1j1U_17aBqig?sub_confirmation=1" target=_blank>youtube</a> </li> </ul> </div> <div class=col-12> <ul class="list-unstyled text-white"> <li class="px-2 bg-white text-dark font-weight-bold list-inline-item">LINKS</li> <li class="mr-2 list-inline-item"><a href=/about>About</a></li> <li class="mr-2 list-inline-item"><a href=/payment>Make Payment</a></li> <li class="mr-2 list-inline-item"><a href=/request>Request Service</a></li> <li class="mr-2 list-inline-item"><a href=/search>Search</a></li> <li class="mr-2 list-inline-item"><a href=/blog>Blog</a></li> <li class="mr-2 list-inline-item"><a href=/contact>Contact</a></li> <li class="mr-2 list-inline-item"><a href=/faq>FAQ</a></li> <li class="mr-2 list-inline-item"><a href=/sitemap.xml>Sitemap</a></li> <li class="mr-2 list-inline-item"><a href=/privacy>Privacy</a></li> </ul> </div> <div class=col-12> <ul class="list-unstyled text-white"> <li class="px-2 list-inline-item text-left bg-white text-dark font-weight-bold">SERVICES PROVIDED</li> <li class="mr-2 list-inline-item"><a href=/blog/2020.07.12-ceiling-fan-installation-with-downrod>Install Ceiling Fan</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2019.07.30-reinforce-bookcase-with-plywood>Bookcase Assembly</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2020.07.21-front-yard-landscaping>Landscaping</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2018.07.21-how-to-replace-toilet-gasket-and-bolts>Toilet Repair</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2018.06.19-replace-optical-drive-in-pc/ >Computer Repair</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2020.03.01-linux-training-session/ >Linux Training</a></li> </ul> </div> <div class=col-12> <ul class="list-unstyled text-white"> <li class="px-2 list-inline-item text-left bg-white text-dark font-weight-bold"> <a class=text-dark href=/faq#what-areas-do-you-serve>SERVICE AREAS</a></li> <li class="mr-2 list-inline-item text-capitalize">Autauga County, Alabama</li> <li class="mr-2 list-inline-item text-capitalize">Elmore County, Alabama</li> <li class="mr-2 list-inline-item text-capitalize">Montgomery County, Alabama</li> <li class="mr-2 list-inline-item"><a href=/faq#what-areas-do-you-serve>Surrounding Areas</a></li> </ul> </div> </div> <hr class="text-white bg-white container"> <div class="text-center text-white bg-black pt-2 pb-5 px-2"> <p> Copyright &copy; 2015-2020 Almost Engineer Services </p> <p class=text-small> Cookies are used on this website to track your visits, provide advertisements specific to you, and preferences by a third-party. By continuing to use this site, you agree to the use of cookies unless you have disabled them. </p> </div> </footer> <script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script> <script>window.jQuery || document.write('<script src="js/vendor/jquery.slim.min.js"><\/script>')</script> <script src=/js/bootstrap.bundle.min.js></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>