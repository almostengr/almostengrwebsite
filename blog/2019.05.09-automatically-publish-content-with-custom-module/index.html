<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0, shrink-to-fit=no"><meta property=og:locale content=en_US><meta property=og:site_name content="Almost Engineer Services"><meta name=twitter:card content=summary><meta name=twitter:site content=@almostengr><meta name=twitter:creator content=@almostengr><meta name=description content="Providing technology and handyman services."><meta property=og:description content="Providing technology and handyman services."><meta name=twitter:description content="Providing technology and handyman services."><meta name=author content="Kenny Robinson, @almostengr"><title>Automatically Publish Content with Custom Module | Almost Engineer Services</title><meta property=og:title content="Automatically Publish Content with Custom Module"><meta name=twitter:title content="Automatically Publish Content with Custom Module"><meta property=og:type content=article><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/blog/2019.05.09-automatically-publish-content-with-custom-module/ rel=canonical><meta content=https://thealmostengineer.com/blog/2019.05.09-automatically-publish-content-with-custom-module/ property=og:url><meta content=https://thealmostengineer.com/blog/2019.05.09-automatically-publish-content-with-custom-module/ property=twitter:url><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-64643711-1"></script><script async>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-64643711-1');
  </script><script async src=https://kit.fontawesome.com/a076d05399.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/almostengrtheme.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/default.min.css><link rel=stylesheet href=/css/a11y-dark-theme.min.css><link rel=stylesheet href=/css/navbar-top-fixed.min.css><!-- Custom styles for by page --><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest></head> <body> <header> <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-black"> <div> <a href=/ class="navbar-brand font-weight-bold">Almost Engineer Services</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav ml-auto"> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/about>Services</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/blog>Blog</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/contact>Contact</a> </li> </ul> <form class="mt-2 mt-md-0" method=GET action=/request> <button class="btn btn-outline-danger mx-2 text-uppercase" id=requestservice type=submit>Request Service</button> </form> </div> </nav> </header> <div class=bg-white> <main role=main class="container py-2"> <div class=row> <div id=content-area class="col-sm-12 col-lg-8 border-lg-right border-dark"> <article> <h1 id=automatically-publish-content-with-custom-module>Automatically Publish Content with Custom Module</h1> <p><img alt src="/images/2019.05.03-Screenshot from 2019-03-07 22-30-01.png"></p> <p>If you want to run a blog, one of the best time saving techniques is writing your content ahead of time and then it is released on a schedule that you set. Drupal does have a module that will do just that. However the process to schedule a post was badly designed in my opinion. That being said, I decided to write my own module that would handle this functionality for me. By writing my own module, I can customize the module how I choose without having additional features that I do not need. In case you are wondering whether this works or not, I am using the code below to publish the blog posts on this website.</p> <p>First you'll need to create a content type if you don't already have one. With Drupal 7, go to Structure &gt; Content Types to create a new content type. When creating the content type, take note to the Machine Name that is associated with your content type. You'll need this later. Next let's take a look at the code:</p> <pre><code class=language-php>function almostengr_publish_posts() {
  $result = db_query(&quot;select nid from {node} where created &amp;lt;= :datetime and promote = :promote and status = :status and type = :type&quot;,
    array(&quot;:datetime&quot; =&amp;gt; REQUEST_TIME, &quot;:promote&quot; =&amp;gt; 1, &quot;:status&quot; =&amp;gt; 0, &quot;:type&quot; =&amp;gt; &quot;article&quot;));
  foreach($result as $row) {
    $article = node_load($row-&amp;gt;nid);
    $article-&amp;gt;status = 1; // update the status
    $article-&amp;gt;comment = 2; // enable comments
    node_save($article); // save article
  } // end foreach
} // end function
</code></pre> <p>The code above queries the node table for the node IDs that have a created date before the current date and time, are selected to be promoted to the front page, are not published, and have a type of article. Then each node that matches the queried condition, will be loaded, have the node status updated to published and the comments enabled, and then saved. Next need to create a cron process that will handle this further. We will do this in code too.</p> <pre><code class=language-php>function almostengr_cron() {
  almostengr_publish_posts();
} // end function
</code></pre> <p>With the code above, we are using cron to call the publish posts function. The cron function within the module that you create will be automatically called via the Drupal hook_cron functionality.</p> <p>Now to the creating of content. When you create a new node, you need to do the following for it to be scheduled to be published:</p> <ul> <li>Set the Created Date to the date and time that you wish the article to be published</li> <li>Promoted to Front Page selected</li> <li>Published status is <strong>not </strong>selected</li> <li>Save the content</li> </ul> <p>That's it. The custom module that you have created will take of the rest.</p> <div class="bg-light border border-danger my-3 p-3 rounded"> <span id=posted><strong>Published:</strong> 2019-05-09</span> <br> <span id=updated><strong>Updated:</strong> 2020-07-15</span><br> <span id=category><strong>Category:</strong> Technology</span><br> <span id=readtime><strong>Read Time:</strong> 2 minute(s)</span><br> </div> </article> </div> <!-- sidebar --> <div id=sidebar class="col-sm-12 col-lg-4 p-2 bg-light-gray"> <div class="mb-3 border border-dark bg-white text-black"> <h4 class="text-left bg-black p-2"> <span class="text-white p-2 font-weight-bold">Request Service</span> </h4> <div class=p-2> <p>Do you have work that needs to be done and are ready to get started?</p> <p><a class="btn btn-danger" href=/request>Get Started!</a></p> </div> </div> <div class="mb-3 border border-dark bg-white text-black"> <h4 class="text-left bg-black p-2"> <span class="text-white p-2 font-weight-bold">Blog and Past Work</span> </h4> <div class=p-2> <p>Check out some of our past projects and work on our blog!</p> <p><a class="btn btn-danger" href=/request>Read Blog</a></p> </div> </div> <div class="mb-3 border border-dark bg-white text-black"> <div class=p-2> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </div> <div class="mb-3 border border-dark bg-white text-black"> <div class=p-2> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </div> </div> <!-- end sidebar --> </div> </main> <p class=container><a href=#top class="text-small text-black">Back to Top</a></p> </div> <footer class="bg-black pt-3"> <div class="container px-0"> <div class="text-white col-12"> <ul class="list-unstyled list-inline"> <li class="px-2 bg-white list-inline-item text-dark font-weight-bold">SOCIAL</li> <li class="mr-2 list-inline-item text-capitalize"> <a href=https://github.com/almostengr target=_blank>github</a> </li> <li class="mr-2 list-inline-item text-capitalize"> <a href=https://instagram.com/almostengr target=_blank>instagram</a> </li> <li class="mr-2 list-inline-item text-capitalize"> <a href=https://twitter.com/almostengr target=_blank>twitter</a> </li> <li class="mr-2 list-inline-item text-capitalize"> <a href="https://www.youtube.com/channel/UC4HCouBLtXD1j1U_17aBqig?sub_confirmation=1" target=_blank>youtube</a> </li> </ul> </div> <div class=col-12> <ul class="list-unstyled text-white"> <li class="px-2 list-inline-item text-left bg-white text-dark font-weight-bold">SERVICES PROVIDED</li> <li class="mr-2 list-inline-item"><a href=/blog/2020.07.12-ceiling-fan-installation-with-downrod>Install Ceiling Fan</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2019.07.30-reinforce-bookcase-with-plywood>Bookcase Assembly</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2020.07.21-front-yard-landscaping>Landscaping</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2018.07.21-how-to-replace-toilet-gasket-and-bolts>Toilet Repair</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2018.06.19-replace-optical-drive-in-pc/ >Computer Repair</a></li> <li class="mr-2 list-inline-item"><a href=/blog/2020.03.01-linux-training-session/ >Linux Training</a></li> </ul> </div> <div class=col-12> <ul class="list-unstyled text-white"> <li class="px-2 bg-white text-dark font-weight-bold list-inline-item">LINKS</li> <li class="mr-2 list-inline-item"><a href=/about>About</a></li> <li class="mr-2 list-inline-item"><a href=/uses>Uses</a></li> <li class="mr-2 list-inline-item"><a href=/payment>Make Payment</a></li> <li class="mr-2 list-inline-item"><a href=/request>Request Service</a></li> <li class="mr-2 list-inline-item"><a href=/search>Search</a></li> <li class="mr-2 list-inline-item"><a href=/blog>Blog</a></li> <li class="mr-2 list-inline-item"><a href=/contact>Contact</a></li> <li class="mr-2 list-inline-item"><a href=/faq>FAQ</a></li> <li class="mr-2 list-inline-item"><a href=/sitemap.xml>Sitemap</a></li> <li class="mr-2 list-inline-item"><a href=/privacy>Privacy</a></li> </ul> </div> </div> <hr class="text-white container"> <div class="text-center text-white bg-black pt-2 pb-5 px-2"> <p>Copyright &copy; 2015-2020 Almost Engineer Services</p> <p class=text-small> Cookies are used on this website to track your visits, provide advertisements specific to you, and preferences by a third-party. By continuing to use this site, you agree to the use of cookies unless you have disabled them. More information this is available in the <a href=/privacy>Privacy Policy</a>. </p> </div> </footer> <script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script> <script>window.jQuery || document.write('<script src="js/vendor/jquery.slim.min.js"><\/script>')</script> <script src=/js/bootstrap.bundle.min.js></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>