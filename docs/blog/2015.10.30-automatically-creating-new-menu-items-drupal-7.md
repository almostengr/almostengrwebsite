echo "# Automatically creating new menu items Drupal 7<br /><br />### <br /><br />### <br />Menu breadcrumbs<br />Drupal breadcrumbs implementation is a never-ending source of <br />frustration for many website developers. A few modules exist which more <br />or less successfully attempt to get Drupal to display meaningful <br />breadcrumbs on every page.<br /><br /><br />One of these modules is <a href="http://drupal.org/project/menu_breadcrumb">menu_breadcrumb</a>, which displays the breadcrumb trail based on current node's menu path. Very useful and sufficient in most use cases.<br /><br /><br />### <br />Limitations and automatic menu modules<br />The only problem with *menu_breadcrumb* is when you're not happy to grant users the *administer menu* permission to create and assign menu items for the content they create.<br /><br /><br />Several Drupal modules exist which work around the permission <br />restriction and automatically create menu items for newly created <br />content nodes. To name a few, <a href="http://drupal.org/project/automenu">Auto Menu</a> and <a href="http://drupal.org/project/automaticmenu">Automatic Menu</a>, both of which are either only available for Drupal 5.x, or their Drupal 6.x implementation is still in beta development stage.<br /><br /><br />### <br />Rules and Drupal API<br />Fortunately, a quick and easy way to create menu items <br />programmatically doesn't even require a standalone module. All we're <br />going to need is the <a href="http://drupal.org/project/rules">Rules</a> module and a bit of Drupal API knowledge.<br /><br /><br />The Rules set of modules allows site administrators to define <br />conditionally executed actions, such as arbitrary PHP code execution, <br />based on occurring events, such as node creation. For the Drupal API <br />part, we'll use a single function <a href="http://api.drupal.org/api/function/menu_link_save">menu_link_save</a>.<br /><br /><br />*menu_link_save* requires an item configuration parameter, whose key names mirror the column names of Drupal's *menu_links* database table.<br /><br /><br />### <br />The solution<br />As mentioned above, we're going to use the *Rules* module. <br />It's installation is pretty straightforward and requires no additional <br />configuration. Let's move right to the setting up our rule.<br /><br /><br />Say we want to create a menu item under *Primary Links* menu's *Blog* item every time a new node of type *Story* is created.<br /><br /><br />Navigate your browser to *Administer » Rules » Triggered rules* page, add a new rule and configure it along the lines of the image:<br /><br /><br /><img alt="Screen-shot of Drupal Rules' configuration screen of a rule which would execute custom PHP code at each creation of a node of type Story" src="http://jan.tomka.name/sites/default/files/rules_auto_menu.jpg" /><br /><br /><br />Finally, we're getting to the PHP snippet itself, which we'll use to <br />automatically create a new menu item every time this rule is triggered. <br />Click *Execute custom PHP code* and insert the following fragment of code:<br /><br /><br /><div class="geshifilter"><br /><pre class="drupal6 geshifilter-drupal6"><span class="re0">$item</span> = <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span><br /> <span class="st0">'link_path'</span> =<span class="sy0">&gt;</span> <span class="st0">'node/'</span> . <span class="re0">$node</span>-<span class="sy0">&gt;</span><span class="me1">nid</span>,<br /> <span class="st0">'link_title'</span> =<span class="sy0">&gt;</span> <span class="re0">$node</span>-<span class="sy0">&gt;</span><span class="me1">title</span>,<br /> <span class="st0">'plid'</span> =<span class="sy0">&gt;</span> <span class="nu0">426</span>,<br /> <span class="st0">'hidden'</span> =<span class="sy0">&gt;</span> <span class="nu0">1</span><br /><span class="br0">)</span>;<br /><a href="http://api.drupal.org/api/function/menu_link_save/6"><span class="kw5">menu_link_save</span></a><span class="br0">(</span><span class="re0">$item</span><span class="br0">)</span>;```<br /><br /><br />Just a few remarks on otherwise pretty simple piece of code.<br /><br /><br /><br />* *menu_link_save* function will only accept normalized path as<br />a link path. When using anything nontrivial for the path, such as the <br />loaded node's *path* property, always use drupal_get_normal_path()  to normalize its value!<br />* *menu_name* is the the machine-readable name of the menu. You can get that from *Administer » Site building » Menus* page as the last component of the menu customization URL.<br />* Value of *plid* is the menu link id of the item you want your<br />item to be a child of. Again, easy to find out, just navigate your <br />browser to the menu's *List items* page and figure out the menu link id of each menu item from its *edit* link URL.<br />* It's up to you whether you want the menu item hidden or displayed by<br />default. I'm using the automatically created menu items just to give *menu_breadcrumb*<br />a when putting together the current page's breadcrumb trail. I don't <br />want the menu items to be visible to the users, that's why i set the *hidden* value to 1.<br /><br /><br /><br /><br /><br /><br />Source: http://jan.tomka.name/blog/programmatically-creating-menu-items-drupal<br /><br />**Posted: 2015-10-30 20:36:38**<br /><br />**Updated: 2019-03-08 20:10:05**<br /><br />
