<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name=description content="The blog of Kenny Robinson"><meta name=author content="Kenny Robinson, @almostengr"><meta name=generator content=Mkdocs><title>Internet Monitor Project - The Almost Engineer</title><link href=/assets/dist/css/bootstrap.min.css rel=stylesheet><script type=text/javascript src=/js/scripts.min.js></script><link href=/css/blog.min.css rel=stylesheet><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:site_name content="The Almost Engineer"><meta name=twitter:card content=summary><meta name=twitter:site content><meta name=twitter:creator content><meta name=description content="The blog of Kenny Robinson"><meta property=og:description content="The blog of Kenny Robinson"><meta name=twitter:description content="The blog of Kenny Robinson"><meta property=og:type content=website><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/projects/internet-monitor/ rel=canonical><meta content=https://thealmostengineer.com/projects/internet-monitor/ property=og:url><meta content=https://thealmostengineer.com/projects/internet-monitor/ property=twitter:url><meta name=author content="Kenny Robinson, @almostengr"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="//www.googletagmanager.com/gtag/js?id="></script><script async>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-64643711-1');</script></head> <body class=bg-dark> <nav class="navbar navbar-expand-md navbar-dark bg-dark pb-2"> <a href=/ class=navbar-brand>The Almost Engineer</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav mr-auto"> <li class=nav-item><a class="nav-link text-light" href=/technology>Technology</a></li> <li class=nav-item><a class="nav-link text-light" href=/lifestyle>Living</a></li> <li class=nav-item><a class="nav-link text-light" href=/projects>Projects</a></li> <li class=nav-item><a class="nav-link text-light" href=/resources>Resources</a></li> </ul> <form class="form-inline mt-2 mt-md-0" action=https://www.google.com/search method=get> <input type=hidden name=q value=site:thealmostengineer.com> <input class="form-control mr-sm-2" type=text placeholder="Search with Google" aria-label=Search name=q> <button class="btn btn-outline-light my-2 my-sm-0" type=submit>Search</button> </form> </div> </nav> <div class="bg-light pt-3 mb-0 pb-0"> <div class=container> </div> <main role=main class=container> <div class=row> <div class="col-md-8 blog-main"> <h1>Internet Monitor Project</h1> <h2 id=problem>Problem</h2> <p>My router would occasionally disconnect any of the wireless clients that were connected to it. Since I have wired and wireless devices connected, some of the time I would not know that the wifi had stopped working until my phone or laptop wouldn't connect or I noticed that a automation did not trigger when it should have.</p> <h2 id=solution>Solution</h2> <p>After updating to the latest <a href=https://dd-wrt.com target=_blank>DD-WRT</a> firmware, the problem persisted. Given that I work building automations to improve business processes, I decided that I would build and automation that would connect to the router’s web interface and see if there are any wireless clients connected to it. If there are no connected wireless clients, then there is a great chance that the wifi process that authenticates clients has crashed. As a result, the process would need to be restarted and the easiest way to restart the process would be to reboot the router.</p> <p>Project was started in 2020.</p> <h2 id=technology>Technology</h2> <ul> <li>C#</li> </ul> <p>This solution uses <a href=https://www.selenium.dev/ target=_blank>Selenium Webdriver</a> to connect to the <a href=https://dd-wrt.com target=_blank>DD-WRT</a> router web interface. I built this using .NET Core, but it could be done on Python, Java, or one of the other platforms that Webdriver works on. I have it set up on server that is always running and it runs as a system service.</p> <h2 id=documentation>Documentation</h2> <h3 id=create-system-service>Create System Service</h3> <pre><code class=language-bash>sudo cp internetmonitor.service /lib/systemd/system
sudo systemctl daemon-reload
sudo systemctl enable internetmonitor
sudo systemctl start internetmonitor
sudo systemctl status internetmonitor
</code></pre> <p>Once all of the commands above have been ran, you should see an output similar to the following:</p> <pre><code class=language-txt>iamadmin@media:/usr/lib$ sudo systemctl status internetmonitor
 internetmonitor.service - Internet Connectivity Monitor by almostengr
     Loaded: loaded (/lib/systemd/system/internetmonitor.service; disabled; vendor preset: enabled)
     Active: active (running) since Fri 2021-01-29 09:03:45 CST; 13s ago
       Docs: https://github.com/almostengr/internetmonitor
   Main PID: 7251 (Almostengr.Inte)
      Tasks: 14 (limit: 38351)
     Memory: 19.0M
     CGroup: /system.slice/internetmonitor.service
             └─7251 /usr/lib/internetmonitor/Almostengr.InternetMonitor

Jan 29 09:03:45 media Almostengr.InternetMonitor[7279]: ChromeDriver was started successfully.
Jan 29 09:03:46 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Performing checks at 01/29/2021 09:03:46 -06:00
Jan 29 09:03:46 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Converting router URL
Jan 29 09:03:51 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Wireless clients are connected. 11 devices found
Jan 29 09:03:51 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Checking the modem status page
Jan 29 09:03:53 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Checking the CM State page
Jan 29 09:03:53 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Browser has been closed
Jan 29 09:03:53 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Done performing checks at 01/29/2021 09:03:53 -06:00
Jan 29 09:03:53 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Sleeping for 600 seconds
Jan 29 09:03:53 media Almostengr.InternetMonitor[7251]: Microsoft.Hosting.Lifetime[0] Application started. Hosting environment: Production; Content root path&gt;
</code></pre> <h3 id=remove-system-service>Remove System Service</h3> <pre><code class=language-bash>sudo systemctl disable internetmonitor
sudo systemctl stop internetmonitor
sudo systemctl status internetmonitor
sudo rm /lib/systemd/system/internetmonitor.service
</code></pre> <p>Once all of the commands above have been ran, you should see an output similar to the following:</p> <pre><code class=language-txt>iamadmin@media:/usr/lib$ sudo systemctl status internetmonitor
 internetmonitor.service - Internet Connectivity Monitor by almostengr
     Loaded: loaded (/lib/systemd/system/internetmonitor.service; disabled; vendor preset: enabled)
     Active: inactive (dead)
       Docs: https://github.com/almostengr/internetmonitor

Jan 29 11:47:48 media systemd[1]: Stopping Internet Connectivity Monitor by almostengr...
Jan 29 11:47:48 media Almostengr.InternetMonitor[7251]: Microsoft.Hosting.Lifetime[0] Application is shutting down...
Jan 29 11:47:48 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Shutting down monitor
Jan 29 11:47:48 media Almostengr.InternetMonitor[7251]: Almostengr.InternetMonitor.Worker[0] Browser has been closed
Jan 29 11:47:48 media systemd[1]: internetmonitor.service: Succeeded.
Jan 29 11:47:48 media systemd[1]: Stopped Internet Connectivity Monitor by almostengr.
</code></pre> <h2 id=source-code>Source Code</h2> <p>To download the source code, visit the <a href=https://github.com/almostengr/internetmonitor target=_blank>code repository</a>.</p> <h2 id=troubleshooting>Troubleshooting</h2> <h3 id=checking-job-log>Checking Job Log</h3> <p>To see the logs for the application when it is ran as system service, run the command</p> <pre><code class=language-bash>journalctl -u internetmonitor -b
</code></pre> <p>or</p> <pre><code class=language-bash>journalctl -u internetmonitor -b -f
</code></pre> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div><!-- /.blog-main --> <aside class="col-md-4 blog-sidebar"> <div class="p-4 mb-3 bg-light rounded shadow"> <h4 class=font-italic>About Kenny</h4> <p class=mb-0> A software developer that builds and fixes things, and writes about the journey. </p> </div> <div class="p-4 shadow mb-3"> <h4 class=font-italic>Get Into Tech</h4> <p class=mb-0> Are you looking to get into a tech career or role? Check out the <a href=/resources>Resources</a> section for more information. Also check out my <a href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1" target=_blank> Tech Talk YouTube Channel</a> and <a href="https://www.facebook.com/profile.php?id=100089303142244" target=_blank> Tech Talk Facebook page</a> for video tutorials about software development, web development, and working with tech. </a> </p> </div> <div class="p-4 shadow mb-3"> <h4 class=font-italic>Connect with Me</h4> <ol class=list-unstyled> <li><a target=_blank href=https://github.com/almostengr>Github</a></li> <li><a target=_blank href=https://facebook.com/rhtservicesllc>Home Improvement (Facebook)</a></li> <li><a target=_blank href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home Improvement (YouTube)</a></li> <li><a target=_blank href=https://instagram.com/almostengr>Instagram</a></li> <li><a target=_blank href=https://stackoverflow.com/users/12875554/almostengr>StackOverflow</a></li> <li><a target=_blank href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a></li> <li><a target=_blank href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk (YouTube)</a></li> <li><a target=_blank href=https://www.tiktok.com/@almostengr>TikTok</a></li> <li><a target=_blank href=https://twitter.com/almostengr>Twitter</a></li> </ol> </div> <div class="p-4 shadow mb-3"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </aside><!-- /.blog-sidebar --> </div><!-- /.row --> </main><!-- /.container --> <footer class="blog-footer bg-dark text-light text-left"> <div class=container> <div> <a class="text-light pr-2" href=/technology>Technology</a> <a class="text-light pr-2" href=/lifestyle>Living</a> <a class="text-light pr-2" href=/projects>Projects</a> <a class="text-light pr-2" href=/resources>Resources</a> <a class="text-light pr-2" href=/services>Services</a> <a class="text-light pr-2" href=/uses>Uses</a> <a class="text-light pr-2" href=/about>About</a> <a class="text-light pr-2" href=/contact>Contact</a> <a class="text-light pr-2" href=/about/privacy>Privacy Policy</a> <a class="text-light pr-2" href=/sitemap.xml>Sitemap</a> </div> <div> <a class="text-light pr-2" target=_blank href=https://facebook.com/rhtservicesllc>Home Improvement (Facebook)</a> <a class="text-light pr-2" target=_blank href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home Improvement (YouTube)</a> <a class="text-light pr-2" target=_blank href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a> <a class="text-light pr-2" target=_blank href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk (YouTube)</a> </div> <div> <a class="text-light pr-2" target=_blank href=https://github.com/almostengr>Github</a> <a class="text-light pr-2" target=_blank href=https://instagram.com/almostengr>Instagram</a> <a class="text-light pr-2" target=_blank href=https://stackoverflow.com/users/12875554/almostengr>StackOverflow</a> <a class="text-light pr-2" target=_blank href=https://www.tiktok.com/@almostengr>TikTok</a> <a class="text-light pr-2" target=_blank href=https://twitter.com/almostengr>Twitter</a> </div> <div>Copyright &copy; 2010-2023 Kenny Robinson</div> <div> Created by <a class=text-light href=https://rhtservices.net target=_blank>Robinson Handy and Technology Services</a> </div> <div> Disclaimer: The opinions expressed here are those of mine and not representative of my employer or affiliates. </div> </div> </footer> </div> </body> </html>