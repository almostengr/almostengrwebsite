<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:site_name content="The Almost Engineer"><meta name=twitter:card content=summary><meta name=twitter:site content=@almostengr><meta name=twitter:creator content=@almostengr><meta name=description content="The steps that I performed to convert by Drupal-based blog over to MkDocs"><meta property=og:description content="The steps that I performed to convert by Drupal-based blog over to MkDocs"><meta name=twitter:description content="The steps that I performed to convert by Drupal-based blog over to MkDocs"><meta name=author content="Kenny Robinson"><title>Blog Conversion Steps | The Almost Engineer</title><meta property=og:title content="Blog Conversion Steps | The Almost Engineer"><meta name=twitter:title content="Blog Conversion Steps | The Almost Engineer"><meta property=og:type content=website><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/technology/2019.12.24-blog-conversion-steps/ rel=canonical><meta content=https://thealmostengineer.com/technology/2019.12.24-blog-conversion-steps/ property=og:url><meta content=https://thealmostengineer.com/technology/2019.12.24-blog-conversion-steps/ property=twitter:url><link href=/css/bootstrap.min.css rel=stylesheet><!-- Custom styles for this template --><link href="//fonts.googleapis.com/css?family=Playfair+Display:700,900" rel=stylesheet><link href=/css/theme.min.css rel=stylesheet><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/default.min.css><link rel=stylesheet href=/css/a11y-dark-theme.min.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.min.css><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest><!-- Global site tag (gtag.js) - Google Analytics --><script async src="//www.googletagmanager.com/gtag/js?id=UA-64643711-1"></script><script async>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-64643711-1');</script></head> <body> <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark-red"> <a href=/ class="navbar-brand font-weight-bold text-uppercase">The Almost Engineer</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav mr-auto"> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/technology>Technology</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/handyman>Handyman</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/gardening>Gardening</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href="https://www.youtube.com/channel/UC4HCouBLtXD1j1U_17aBqig?sub_confirmation=1">YouTube</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/projects>Projects</a> </li> </ul> <form class="form-inline mt-2 mt-md-0" action=/search2> <button class="btn btn-outline-light my-2 my-sm-0" type=submit>Search</button> </form> </div> </nav> <div class="pt-3 mt-0 bg-white"> <main role=main class=container> <div class=row> <div class="col-sm-12 col-md-9 blog-main"> <ul class="list-unstyled  breadcrumb "> <li class=list-inline-item><a href=/ >Home</a></li> <li class=list-inline-item>&raquo; <a href=..>Technology</a></li> <li class=list-inline-item>&raquo; Blog Conversion Steps</li> </ul> <h1 class=blog-post-title> Blog Conversion Steps </h1> <p class="text-center blog-post-meta text-secondary"> <em> a 9 minute read posted on 2019-12-24 last updated on 2020-07-15 by Kenny Robinson in <a href=/technology>Technology</a> </em> </p> <div class=pb-3> <a class=a2a_dd href=https://www.addtoany.com/share> <img src=https://static.addtoany.com/buttons/share_save_171_16.png height=16 alt=Share> </a> </div> <!-- home page listing --> <p><ul class=list-unstyled> </ul><ul class=list-unstyled> </ul><ul class=list-unstyled> </ul><ul class=list-unstyled> </ul><ul class=list-unstyled> </ul></p> <div class=content> <h1 id=blog-conversion-steps>Blog Conversion Steps</h1> <p>If you read my <a href=/2019.12.21-switched-blog-from-drupal-to-mkdocs>previous post</a>, you found out why I chose to migrate away from a CMS (Content Management System). </p> <p>The conversion that I did for my website, took about 30-40 hours. That was a combination of a few evenings after work and a full weekend. To give you a perspective, I only had about 120 nodes on my Drupal site that had to be converted. Some of the more recent nodes, were already in Markdown format, so only formatting and presentation changes needed to be made. The other nodes were in various formats, including plain text and HTML (filter and full). </p> <h2 id=do-the-setup>Do The Setup</h2> <p>In order to create a website with MkDocs, you will need to do some initial setup . I did my updates on Ubuntu. Therefore I was able to run </p> <pre><code class=language-bash>sudo apt-get install mkdocs
</code></pre> <p>and the rest was done auto-magically. Setup is similar for Mac users. Windows users, you’ll need to install Python and then the MkDocs pip package. Instructions on how to do this are available on the <a href=https://mkdocs.org target=_blank>MkDocs website</a>.</p> <h2 id=stop-creating-content>Stop Creating Content</h2> <p>Similar to how difficult it is to drain a bath tub if the water is still running, you will need to stop creating content until you do your migration. Otherwise, you will never complete the conversion process. </p> <p>I will admit, I did write two new posts while going through the conversion process. One about <a href=/technology/2019.12.21-switched-blog-from-drupal-to-mkdocs>switching to Markdown and MkDocs</a> and the other about <a href=https://almostengr.github.io/gardening/2019.12.22-you-still-rake-leaves/ >raking leaves</a>. Those posts, were written in new site that I was actively working on and not deployed to the old site since it was on the way to the digital landfill.</p> <h2 id=backup-and-export-the-database>Backup and Export The Database</h2> <p>Before you start messing with your content, make a backup of the database and your website code and put it on a system that you will not be working on. That way if you do something wrong (yes it happened several times), then you have something that you can redo your changes from. </p> <p>I copied the production database of my website, as well as the master branch of code to my development server. Then I performed all of the updates in my development environment. </p> <p>I did it this way because that allows my website to continue to remain active. Also, in the worse case of making mistakes, which did happen, those mistakes were not seen by end users as only I have access to my development server.</p> <h2 id=convert-tables-to-markdown>Convert Tables to Markdown</h2> <p>Next was to get the posts and other website content into Markdown format. As previously mentioned, some of the content was written in HTML or plain text formats. </p> <p>What I chose to do was to write some database queries that would format the existing data into or close to the format that I wanted the markdown file to be in. The final output was contained in a column in a temporary table that I was using to make the necessary changes ad adjustments. The queries that I used to make this update are in the SQL file located at <a href=https://github.com/almostengr/almostengrwebsite/tree/master/migration_scripts>https://github.com/almostengr/almostengrwebsite/tree/master/migration_scripts</a>.</p> <p>Using a number of update statements, I was able to convert the HTML syntax to Markdown. Some of the tags were too complex to convert, so I left those in the database and fixed them after I did the export to a text file.</p> <h2 id=export-the-markdown>Export the Markdown</h2> <p>Next, I did an export of the data to a CSV file. Now I only exported the column that had the finalized output and the title of each post. I did this using PHPMyAdmin as I have a MySQL database installed. Be sure to select the option that removes the carriage returns and line breaks from the export.</p> <p>After that, I assembled a command that would read each line in the CSV file, take the first column of the CSV file and put it into the body of the Markdown file and take the second column of the CSV file and use it to name the CSV file. This was done through the use of a while loop and the <code>awk</code> command. Take a look at <code>csv_to_individual_files.sh</code> script in the migration_scripts directory.</p> <p>After that, I did the file cleanup. The file clean up removed the additional characters that were present from the CSV file as well as converted the line breaks (&lt;br /&gt; tags) to new line characters. This way the final file will will not be one long line.</p> <h2 id=copy-images-and-supporting-files>Copy Images and Supporting Files</h2> <p>Next, I copied the images that were used on my Drupal site into an images directory. I put all of the images into a single directory. Then I had to update the Markdown files to use relative paths to these files. Now you can use absolute references to the files, but that may cause you to miss errors when you are developing new content as you will need to use production URLs when setting up the links. If you do not have the image in production when creating new content, you will get no image or the alternate text for that image. </p> <h2 id=structure-and-configure-your-website>Structure and Configure Your Website</h2> <h3 id=blog-categories>Blog Categories</h3> <p>How you structure your website can make a big difference when it comes to SEO and user experience. When I used Drupal, all I had to do was select the appropriate taxonomy category and the URL part was handled. With the Markdown site, I’m having to do the structure manually. I found it best to place each post in a folder based upon the category that it was intended for. In addition, I named each file with the date that I created the article and the title of the article. By having this information in the URL, it better helps the search engines index my blog.</p> <p>My folders tree looks similar to the following: </p> <pre><code>docs
 | index.md
 | 2018
    | 2018.02.13-use-twitter-and-rules-for-farmos-notifications/
    | 2018.01.23-raspitraffic-demo,-us-signaling/
    | 2018.01.16-raspberry-pi-first-run-and-installing-updates/
 | 2019
    | 2019.12.21-switched-blog-from-drupal-to-mkdocs/
    | 2019.12.20-blog-reverse-sort-with-mkdocs/
    | 2019.12.24-blog-conversion-steps
</code></pre> <h3 id=sort-by-date>Sort by Date</h3> <p>One of the downfalls to using Markdown, is that it sorts by alphabetical and numeric order. Meaning that my oldest posts would show up first. Nobody wants to have to scroll down to the bottom of the page to see the latest post that you wrote. What I needed up having to do was to leverage the <code>find</code>, <code>sort</code>, and <code>sed</code> commands to list the files in reverse order. Once I got them in the most recent post first order, I put them into the MkDocs configuration file (mkdocs.yml). After they were in the configuration file, then I added group headings based on the categories. The code that I used for this is available in the <code>sort_by_latest_post.sh</code> file in the migration_scripts directory.</p> <h2 id=proofread-proofread-proofread>Proofread, Proofread, Proofread</h2> <p>I went through each of the posts and attempted to correct as many of the formatting and Markdown errors that I could. Some of the errors, I realized were due to a lack of formatting that was done during the database step. So I truncated the temporary table and updated the update database query so that the additional formatting changes could be applied there instead of having to use <code>sed</code> or some other command via the terminal. Some of the HTML formatting I could not remove because of some of the difficulties of trying to match some particular text. So I left it in place for it to be manually modified. As I mentioned earlier, I only had about 120 pages that I had to go through and correct. If you have a blog with thousands or more posts, you may want to have a team help you or build more queries that will make the necessary code updates before deploying. </p> <h2 id=deploy-to-production>Deploy To Production</h2> <h3 id=not-exactly-perfect>Not Exactly Perfect</h3> <p>Once I was satisfied, I deployed it to production. There are some articles that do not have images contained in them because the image link is incorrect. There are other images that are way too large for the post, and I will need to resize them to make them more appropriate. I will do that at a later date. </p> <p>I deployed my updated site by using the <code>mkdocs gh-deploy</code> command. This creates a separate branch on your repo to deploy to. Then it will generate the static files for your website and push those files to the gh-pages branch.</p> <h3 id=set-up-automated-pull-or-ci>Set up Automated Pull or CI</h3> <p>I added a cron job on my production instance that will periodically pull the latest version of the gh-pages to the production server. This will eliminate my need to login to the production instance unless there is a critical failure with the script or something else goes wrong. </p> <p>If you are not able to do a cron job, you can also use a CI server that will do the production deployment for you. Travis is one that is popular to use with Github.</p> <h2 id=conclusion>Conclusion</h2> <p>I am happy with the new setup. The biggest advantage is that I do not have to spend time performing module updates or backups of the Drupal database. Further more, the simplicity of writing blog posts much better as I do not need specialized tools to complete the task.</p> <div class=pb-3> <a class=a2a_dd href=https://www.addtoany.com/share> <img src=https://static.addtoany.com/buttons/share_save_171_16.png height=16 alt=Share> </a> </div> <!-- mobile page links --> </div> <div class="bg-warning my-3 p-2"> I enjoy sharing the content that you find here. Instead of asking donations, I ask that you consider purchasing an item on my <a href="https://www.amazon.com/hz/wishlist/ls/38QKZTVCEAUK3?ref_=wl_share" target=_blank>Amazon Wish List</a>. </div> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> <!-- </div> --> </div><!-- /.blog-main --> <aside class="col-md-3 blog-sidebar"> <div class="p-4 mb-3 bg-light rounded"> <h4 class=font-italic>Connect With Me</h4> <ol class=list-unstyled> <li><a href=https://github.com/almostengr target=_blank><i class="bi bi-github"></i> GitHub</a></li> </svg> <li><a href=https://www.instagram.com/almostengr target=_blank><i class="bi bi-instagram"></i> Instagram</a></li> </svg> <li><a href=https://www.linkedin.com/in/krobinsontech target=_blank><i class="bi bi-linkedin"></i> LinkedIn</a></li> </svg> <li><a href=https://twitter.com/almostengr target=_blank><i class="bi bi-twitter"></i> Twitter</a></li> </svg> <li><a href="https://www.youtube.com/channel/UC4HCouBLtXD1j1U_17aBqig?sub_confirmation=1" target=_blank><i class="bi bi-youtube" &quot;></i> YouTube</a></li> </svg> </ol> </div> <div class="p-4 mb-3 bg-light rounded"> <a class=a2a_dd href=https://www.addtoany.com/share> <img src=https://static.addtoany.com/buttons/share_save_171_16.png width=171 height=16 alt=Share> </a> </div> <div class="p-4 mb-3 bg-light rounded"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> <div class="p-4 mb-3 bg-light rounded"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </aside><!-- /.blog-sidebar --> </div><!-- /.row --> </main><!-- /.container --> </div> <footer class="blog-footer bg-black container text-left"> <p class=text-center><a href=#>Back To Top</a></p> <div class=row> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold"> SOCIAL </li> <li class=px-3> <a href=https://github.com/almostengr><i class="bi bi-github"></i> GitHub</a> </li> <li class=px-3> <a href=https://www.instagram.com/almostengr><i class="bi bi-instagram"></i> Instagram</a> </li> <li class=px-3> <a href=https://www.linkedin.com/in/krobinsontech><i class="bi bi-linkedin"></i> LinkedIn</a> </li> <li class=px-3> <a href=https://twitter.com/almostengr><i class="bi bi-twitter"></i> Twitter</a> </li> <li class=px-3> <a href="https://www.youtube.com/channel/UC4HCouBLtXD1j1U_17aBqig?sub_confirmation=1"><i class="bi bi-youtube"></i> YouTube</a> </li> </ul> </div> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold"> BLOG </li> <li class=px-3> <a href=/technology><i class="bi bi-journal-text"></i> Technology</a> </li> <li class=px-3> <a href=/handyman><i class="bi bi-journal-text"></i> Handyman</a> </li> <li class=px-3> <a href=/gardening><i class="bi bi-journal-text"></i> Gardening</a> </li> <li class=px-3> <a href=/lifestyle><i class="bi bi-journal-text"></i> Lifestyle</a> </li> </ul> </div> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold"> PROJECTS </li> <li class=px-3> <a href=/lightshow><i class="bi bi-lightbulb"></i> Christmas Light Show</a> </li> <li class=px-3> <a href=/falconpitwitter><i class="bi bi-cpu-fill"></i> Falcon Pi Twitter</a> </li> <li class=px-3> <a href=/resources><i class="bi bi-bookshelf"></i> Resources</a> </li> <li class=px-3> <a href=/speaking><i class="bi bi-megaphone-fill"></i> Speaking</a> </li> <li class=px-3> <a href=/trafficpi><i class="bi bi-stoplights"></i> Traffic Pi</a> </li> <li class=px-3> <a href=/projects><i class="bi bi-journal"></i> All Projects</a> </li> </ul> </div> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold"> LINKS </li> <li class=px-3> <a href="https://www.youtube.com/watch?v=iujOWWbiUP0&list=PLaAJ0fv0d9WM8E2K_Ke5As-fw626yQ3tu"><i class="bi bi-camera-video-fill"></i> Drupal 8 Basics Course</a> </li> <li class=px-3> <a href=/about><i class="bi bi-file-person-fill"></i> About</a> </li> <li class=px-3> <a href=/uses><i class="bi bi-tools"></i> Uses</a> </li> <li class=px-3> <a href=/contact><i class="bi bi-person-lines-fill"></i> Contact</a> </li> <li class=px-3> <a href=/sitemap.xml><i class="bi bi-diagram-3"></i> Sitemap</a> </li> <li class=px-3> <a href=/privacy><i class="bi bi-shield-shaded"></i> Privacy</a> </li> </ul> </div> </div> <p> Copyright &copy; 2021 Kenny Robinson | Website built and maintained by <a href=https://rhtservices.net target=_blank>Robinson Handy and Technology Services LLC</a> </p> <p> Cookies are used on this website to track your visits, provide advertisements specific to you, and preferences by a third-party. By continuing to use this site, you agree to the use of cookies unless you have disabled them. More information this is available in the <a href=/privacy>Privacy Policy</a>. </p> </footer> <script src=//code.jquery.com/jquery-3.5.1.slim.min.js async integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script> <script>window.jQuery || document.write('<script src="/js/vendor/jquery.slim.min.js"><\/script>')</script> <script async src=/js/bootstrap.bundle.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js></script> <script src=/js/theme.min.js defer></script> <script>let getUrl = window.location; var base_url = getUrl.protocol + "//" + getUrl.host + "/";</script> <script src=/search/main.js defer></script> <script>hljs.initHighlightingOnLoad();</script> <script type=text/javascript async>var a2a_config = a2a_config || {}; a2a_config.onclick = 1;</script> <script async src=https://static.addtoany.com/menu/page.js></script> <!-- Build Date UTC : 2021-06-08 02:00:15.067923+00:00 --> </body> </html>