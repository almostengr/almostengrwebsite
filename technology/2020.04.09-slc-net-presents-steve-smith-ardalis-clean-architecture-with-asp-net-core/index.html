<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name=description content="The blog of Kenny Robinson"><meta name=author content="Kenny Robinson, @almostengr"><meta name=generator content=Mkdocs><title>SLC.NET Presents: Steve Smith (ardalis) - Clean Architecture with ASP.NET Core - The Almost Engineer</title><link href=/assets/dist/css/bootstrap.min.css rel=stylesheet><link href=/css/blog.min.css rel=stylesheet><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:site_name content="The Almost Engineer"><meta name=twitter:card content=summary><meta name=twitter:site content><meta name=twitter:creator content><meta name=description content="Attended a .NET Core presentation with Steve Smith regarding clean architecture."><meta property=og:description content="Attended a .NET Core presentation with Steve Smith regarding clean architecture."><meta name=twitter:description content="Attended a .NET Core presentation with Steve Smith regarding clean architecture."><meta name=keywords content=".net core, .net, programming, coding, steve smith, asp.net, c#, computer programming, workshops"><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/technology/2020.04.09-slc-net-presents-steve-smith-ardalis-clean-architecture-with-asp-net-core/ rel=canonical><meta content=https://thealmostengineer.com/technology/2020.04.09-slc-net-presents-steve-smith-ardalis-clean-architecture-with-asp-net-core/ property=og:url><meta content=https://thealmostengineer.com/technology/2020.04.09-slc-net-presents-steve-smith-ardalis-clean-architecture-with-asp-net-core/ property=twitter:url><meta name=author content="Kenny Robinson"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="//www.googletagmanager.com/gtag/js?id="></script><script async>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-64643711-1');</script></head> <body class=bg-dark> <nav class="navbar navbar-expand-md navbar-dark bg-dark pb-2"> <a href=/ class=navbar-brand>The Almost Engineer</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav mr-auto"> <li class=nav-item><a class="nav-link text-light" href=/technology>Technology</a></li> <li class=nav-item><a class="nav-link text-light" href=/lifestyle>Living</a></li> <li class=nav-item><a class="nav-link text-light" href=/projects>Projects</a></li> <li class=nav-item><a class="nav-link text-light" href=/resources>Resources</a></li> <li class=nav-item><a class="nav-link text-light" href=/lightshow>Light Show</a></li> </ul> <form class="form-inline mt-2 mt-md-0" action=https://www.google.com/search method=get> <input type=hidden name=q value=site:thealmostengineer.com> <input class="form-control mr-sm-2" type=text placeholder="Search with Google" aria-label=Search name=q> </form> </div> </nav> <div class="bg-light pt-3 mb-0 pb-0"> <div class=container> </div> <main role=main class=container> <div class=row> <div class="col-md-8 blog-main"> <h1>SLC.NET Presents: Steve Smith (ardalis) - Clean Architecture with ASP.NET Core</h1> <p>Below are the notes that I took from this online presentation with <a href=https://twitter.com/ardalis target=_blank>Steve Smith</a>. This presentation was done very early into the COVID-19 pandemic. In an effort to learn more about C# and the .NET Core framework, I found that this event was happening on <a href=https://www.meetup.com target=_blank>Meetup</a>. So I decided to attend. You can also join <a href=https://www.meetup.com/The-SLC-NET-User-Group/ target=_blank>The SLC .NET User Group</a> on Meetup.</p> <h2 id=applying-clean-architecture-to-aspnet-core>Applying Clean Architecture to ASP.NET Core</h2> <p>April 9, 2020</p> <h2 id=separation-of-concerns>separation of concerns</h2> <ul> <li>dont let your plumbing code pollute your software</li> <li>avoid mixing different code responsibilties in the same method, class or project</li> </ul> <h3 id=the-big-three>the big three</h3> <ul> <li>data access</li> <li>business rules and domain model</li> <li>user interface</li> </ul> <h2 id=single-responsibiity>single responsibiity</h2> <ul> <li>avoid tightly coupling your tools together</li> <li>works in tandem with Separation of Concenrs</li> <li>class should focus on single responsibily; should only have one reason to change</li> </ul> <h2 id=dont-repeat-yourself-dry>Dont Repeat Yourself (DRY)</h2> <ul> <li>put repetitive code into functions</li> <li>group functions into cohesive classes; dealing with the same responsbility</li> <li>group classes by folders and namespaces by responsibiltiy, level of abstraction, etc</li> <li>further group class folders into projects</li> </ul> <h2 id=dependency-inversion>Dependency Inversion</h2> <ul> <li>Would you solder a lamp directly into the electrical wiring in a wall?</li> </ul> <h2 id=invert-and-inject-dependencies>invert (and inject) dependencies</h2> <ul> <li>both high level classes and implementation-detail classes should depend on abstractions (interfaces); should not be hard coded</li> <li>classes should follow explicit dependencies principle; classes should be explicit about all of the classes that they need; dependencies are defined in the class constructor</li> <li>make your types honest, not deceptive</li> <li>dont have a constructor with a lot of dependencies. consider using additional classes if this is the case</li> <li>advised not to use property dependency injection</li> </ul> <h3 id=abstractionsinferfaces-must-be-defined-somewhere-accessible-by>abstractions/inferfaces must be defined somewhere accessible by</h3> <ul> <li>low level implemetnation services</li> <li>high level business services</li> <li>user interface entry points; usually done in configure services</li> </ul> <h2 id=dependency-graphs>Dependency Graphs</h2> <h3 id=direct-dependency-graph>Direct Dependency Graph</h3> <ul> <li>Class A -&gt; Class B -&gt; Class C</li> </ul> <h3 id=inverted-dpedency-graph>Inverted dpedency graph</h3> <ul> <li>Class A -&gt; Inteface B -&gt; Class B -&gt; Interface C -&gt; Class C</li> <li>this allows the actual class to be swapped out and easier to test</li> </ul> <h2 id=make-the-right-thing-easy-and-the-wrong-thing-hard>Make the right thing easy and the wrong thing hard</h2> <ul> <li>UI classes shouldnt depend on infrastructure classes (file system, database, external resources, etc)</li> <li>how can we strcuture our solution to help enforce this?</li> <li>business / domain classes shouldnt depend on infrastructure classes</li> <li>avoid repeating or copy pasting (DRY)</li> </ul> <h2 id=class-n-tier-architecture-or-n-layer>Class N Tier Architecture (or N Layer)</h2> <ul> <li>originally, everything was in the same layer (Classical)</li> <li>over time, that changed to N-tier where each layer is separated</li> </ul> <h3 id=transitive-dependencies>Transitive dependencies</h3> <ul> <li>this resulted in everything on the database because the top layer depended on the later below it</li> <li>this mean that the database had to be reset each time the tests were ran</li> </ul> <h2 id=domain-centric-design>domain-centric design</h2> <ul> <li>better than data centric design</li> </ul> <h3 id=domain-model>domain model</h3> <ul> <li>model of the problem that exists of entities, interfaces, services, and more</li> <li>should be able to work independent of the database</li> <li>interfaces define contracts for work with domain objects</li> <li>everything in the application (including infrasctrucutre and data access) depends on these interfaces and domain objects</li> </ul> <h2 id=clean-architecture-aka-onion-architecture>clean architecture (aka Onion Architecture)</h2> <ul> <li>each layer points to the inside layer</li> <li>the domain entities at the center; they should be protected from being coupled; it makes things easier to test</li> <li> <p>the middle circles are what everything depends on; outer circles are other services and depend on the things in the middle</p> </li> <li> <p>domain model represents the entities and abstractions; not the repository thought, just the interface</p> </li> </ul> <h2 id=clean-architecture-rules>clean architecture "rules"</h2> <ul> <li>application core contains the domain model</li> <li>all projects depends on the core project; dependencies point inward to the application core</li> <li>inner projects define intefaces; outer projects implement them (like infrastructure)</li> <li>abstraction lives in core; impementation lives in outter</li> <li>avoid direct depednecy on the infrastructure project (except from integration test and possbily startup.cs); controllers should not be using things from the infrastructure</li> <li>framework independent</li> <li>database independent</li> <li>UI independent</li> <li>it is very testable</li> <li>everything knows about core</li> </ul> <h2 id=refactoring-to-a-clean-architecture>refactoring to a clean architecture</h2> <ul> <li>best: start from properly configured project</li> <li>next best: start from single application project</li> <li>most difficult: large, existing investment in multilayer architecture</li> </ul> <h2 id=the-core-project-domain>the core project (domain)</h2> <p>Minimal dependencies - none on infrastructure What goes in it</p> <ul> <li>interfaces</li> <li>entities, value objects, aggregates</li> <li>domain services</li> <li>custom exceptions</li> <li>domain events</li> <li>event handlers</li> <li>specifications</li> </ul> <h2 id=infrastructure-project>infrastructure project</h2> <p>all dependencies on out of process resources</p> <ul> <li>repositories</li> <li>ef core, dbcontext</li> <li>cached repositories</li> <li>web api clients</li> <li>file system</li> <li>logging</li> <li>email / sms sending</li> <li>system clock</li> <li>other services</li> <li>interfaces (sometimes; these are for the ones that depends on infrastructure stuff)</li> </ul> <h2 id=web-project>web project</h2> <ul> <li>controllers </li> <li>views </li> <li>view models (or api models, or binding models)</li> <li>filters </li> <li>binders </li> <li>tag / html helpers </li> <li>other services </li> <li>interfaces (that depend on UI stuff)</li> </ul> <h2 id=shared-kernel>shared kernel</h2> <ul> <li>items that are shared between multiple solutions </li> <li>referenced by the core projects</li> <li>ideally distributed as nuget packages </li> </ul> <h1 id=solution-structure-clean-architecture>solution structure - clean architecture</h1> <p>functional test -&gt; web web -&gt; infrastructure web -&gt; core infrastructure -&gt; core unit tests -&gt; core integration tests -&gt; infrastructure core -&gt; shared kernel </p> <h2 id=how-to-keep-controllers-smaller>how to keep controllers smaller</h2> <ul> <li>dont use a lot of logic in them; especially if it is not UI related </li> <li>accept a type (view model, api model) </li> <li>perform model validation </li> <li>do work </li> <li>create model required for response </li> <li>return with result type (view, page, ok, not found)</li> </ul> <h3 id=do-work>do work</h3> <ul> <li>get entity from injected repository </li> <li>work with the entity and its methods </li> <li>update the entitys state using the repository </li> </ul> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div><!-- /.blog-main --> <aside class="col-md-4 blog-sidebar"> <div class="p-4 mb-3 bg-light rounded shadow"> <h4 class=font-italic>About Kenny</h4> <p class=mb-0> A software developer that builds and fixes things, and writes about the journey. </p> </div> <div class="p-4 shadow mb-3"> <h4 class=font-italic>Get Into Tech</h4> <p class=mb-0> Are you looking to get into a tech career or role? Check out the <a href=/resources>Resources</a> section for more information. Also check out my <a href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1" target=_blank> Tech Talk YouTube Channel</a> and <a href="https://www.facebook.com/profile.php?id=100089303142244" target=_blank> Tech Talk Facebook page</a> for video tutorials about software development, web development, and working with tech. </a> </p> </div> <div class="p-4 shadow mb-3"> <h4 class=font-italic>Connect with Me</h4> <ol class=list-unstyled> <li><a target=_blank href=https://github.com/almostengr>Github</a></li> <li><a target=_blank href=https://facebook.com/rhtservicesllc>Home Improvement (Facebook)</a></li> <li><a target=_blank href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home Improvement (YouTube)</a></li> <li><a target=_blank href=https://instagram.com/almostengr>Instagram</a></li> <li><a target=_blank href=https://stackoverflow.com/users/12875554/almostengr>StackOverflow</a></li> <li><a target=_blank href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a></li> <li><a target=_blank href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk (YouTube)</a></li> <li><a target=_blank href=https://www.tiktok.com/@almostengr>TikTok</a></li> <li><a target=_blank href=https://twitter.com/almostengr>Twitter</a></li> </ol> </div> <div class="p-4 shadow mb-3"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </aside><!-- /.blog-sidebar --> </div><!-- /.row --> </main><!-- /.container --> <footer class="blog-footer bg-dark text-light text-left"> <div class=container> <div> <a class="text-light pr-2" href=/technology>Technology</a> <a class="text-light pr-2" href=/lifestyle>Living</a> <a class="text-light pr-2" href=/projects>Projects</a> <a class="text-light pr-2" href=/resources>Resources</a> <a class="text-light pr-2" href=/services>Services</a> <a class="text-light pr-2" href=/uses>Uses</a> <a class="text-light pr-2" href=/about>About</a> <a class="text-light pr-2" href=/contact>Contact</a> <a class="text-light pr-2" href=/about/privacy>Privacy Policy</a> <a class="text-light pr-2" href=/sitemap.xml>Sitemap</a> </div> <div> <a class="text-light pr-2" target=_blank href=https://facebook.com/rhtservicesllc>Home Improvement (Facebook)</a> <a class="text-light pr-2" target=_blank href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home Improvement (YouTube)</a> <a class="text-light pr-2" target=_blank href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a> <a class="text-light pr-2" target=_blank href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk (YouTube)</a> </div> <div> <a class="text-light pr-2" target=_blank href=https://github.com/almostengr>Github</a> <a class="text-light pr-2" target=_blank href=https://instagram.com/almostengr>Instagram</a> <a class="text-light pr-2" target=_blank href=https://stackoverflow.com/users/12875554/almostengr>StackOverflow</a> <a class="text-light pr-2" target=_blank href=https://www.tiktok.com/@almostengr>TikTok</a> <a class="text-light pr-2" target=_blank href=https://twitter.com/almostengr>Twitter</a> </div> <div>Copyright &copy; 2010-2023 Kenny Robinson</div> <div> Created by <a class=text-light href=https://rhtservices.net target=_blank>Robinson Handy and Technology Services</a> </div> <div> Disclaimer: The opinions expressed here are those of mine and not representative of my employer or affiliates. </div> </div> </footer> </div> <script type=text/javascript src=/js/scripts.min.js></script> </body> </html>