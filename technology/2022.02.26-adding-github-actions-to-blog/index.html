<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name=description content="The blog of Kenny Robinson"><meta name=author content="Kenny Robinson, @almostengr"><meta name=generator content=Mkdocs><title>Adding GitHub Actions to Blog - The Almost Engineer</title><link href=/assets/dist/css/bootstrap.min.css rel=stylesheet><link href=/css/blog.min.css rel=stylesheet><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:site_name content="The Almost Engineer"><meta name=twitter:card content=summary><meta name=twitter:site content><meta name=twitter:creator content><meta name=description content="I share how I went about adding Github Actions to my blog."><meta property=og:description content="I share how I went about adding Github Actions to my blog."><meta name=twitter:description content="I share how I went about adding Github Actions to my blog."><meta name=keywords content="github actions, cicd, automated deployment, continuous integration, continuous deployment, github,"><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/technology/2022.02.26-adding-github-actions-to-blog/ rel=canonical><meta content=https://thealmostengineer.com/technology/2022.02.26-adding-github-actions-to-blog/ property=og:url><meta content=https://thealmostengineer.com/technology/2022.02.26-adding-github-actions-to-blog/ property=twitter:url><meta name=author content="Kenny Robinson, @almostengr"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="//www.googletagmanager.com/gtag/js?id="></script><script async>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-64643711-1');</script></head> <body class=bg-dark> <nav class="navbar navbar-expand-md navbar-dark bg-dark pb-2"> <a href=/ class=navbar-brand>The Almost Engineer</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav mr-auto"> <li class=nav-item><a class="nav-link text-light" href=/technology>Technology</a></li> <li class=nav-item><a class="nav-link text-light" href=/lifestyle>Living</a></li> <li class=nav-item><a class="nav-link text-light" href=/projects>Projects</a></li> <li class=nav-item><a class="nav-link text-light" href=/resources>Resources</a></li> <li class=nav-item><a class="nav-link text-light" href=/lightshow>Light Show</a></li> </ul> <form class="form-inline mt-2 mt-md-0" action=https://www.google.com/search method=get> <input type=hidden name=q value=site:thealmostengineer.com> <input class="form-control mr-sm-2" type=text placeholder="Search with Google" aria-label=Search name=q> </form> </div> </nav> <div class="bg-light pt-3 mb-0 pb-0"> <div class=container> </div> <main role=main class=container> <div class=row> <div class="col-md-8 blog-main"> <h1>Adding GitHub Actions to Blog</h1> <h2 id=background>Background</h2> <p>As you may know, I use MkDocs to generate the static pages for my website. This means that the posts that I write are written in Markdown and then I have to run a couple of Python commands to convert those Markdown files to static HTML files. </p> <p>I decided to use GitHub pages to automation this portion of the publishing process. This will allow me to make updates to the website or publish new posts from anywhere that has an internet connection.</p> <h2 id=cd-continuous-deployment-completed>CD (Continuous Deployment) Completed</h2> <p>Prior to setting up GitHub Actions, I had my Production environment already pulling the latest version of the gh-pages branch of my website repository. This automated pull is done via cronjob that runs every 3 hours. </p> <h2 id=setting-up-github-actions>Setting Up GitHub Actions</h2> <p>To get started with GitHub Actions, you can go to the repository that you have some tasks that you want to automate and click on the Actions tab on the page. </p> <p>If you do not have any actions set up for the repository, you will be presented with a list of defined workflows that you can immediately use in your repository. Since there was not a workflow for MkDocs, I had to create my workflow from scratch.</p> <p>In order to get my workflow going, I used a combination of looking at the workflows that others had created and the Github Actions documentation.</p> <p>My workflow file to automatically generate the static files is broken down as follows: </p> <h3 id=name-of-the-workflow>Name of the workflow</h3> <pre><code class=language-yaml>name: Generate static pages
</code></pre> <h3 id=trigger-for-the-workflow>Trigger for the Workflow</h3> <pre><code class=language-yaml>on:
    push: 
        branches:
            - master

    pull_request:
        branches:
            - master
</code></pre> <p>This defines the trigger for when the workflow should be started. In my case, I set it to trigger when a push is done or a pull request is done on the master branch.</p> <h3 id=jobs-and-build>Jobs and Build</h3> <pre><code class=language-yaml>jobs:
    build:
</code></pre> <h3 id=operating-system>Operating System</h3> <pre><code class=language-yaml>name: buildout
    runs-on: ubuntu-latest
</code></pre> <h3 id=steps-to-do>Steps to Do</h3> <pre><code class=language-yaml>steps:
- name: Checkout latest master
    uses: actions/checkout@v2
    with: 
        repository: almostengr/almostengrwebsite
</code></pre> <h3 id=commands>Commands</h3> <pre><code class=language-yaml>- name: Installing Python
  run:  python -m pip install --upgrade pip
</code></pre> <h2 id=handling-errors>Handling Errors</h2> <h3 id=mkdocs-command-not-found>mkdocs command not found</h3> <pre><code class=language-bash>Run mkdocs gh-deploy
/home/runner/work/_temp/19138cfe-7455-4470-a2a3-bd90113d693e.sh: line 1: mkdocs: command not found
##[error]Process completed with exit code 127.
</code></pre> <p>When attempting to run the command to deploy the MkDocs website, I would receive the above message. Looking on the MkDocs documentation, I found that it mentioned on Windows systems that "python -m" may need to be used in order to execute a command. </p> <p>So if you receive the above error message, then change the command from </p> <pre><code class=language-bash>mkdocs gh-deploy
</code></pre> <p>to </p> <pre><code class=language-bash>python -m mkdocs gh-deploy
</code></pre> <p>in your workflow file.</p> <h3 id=not-a-commit-or-a-branch>Not A Commit or A Branch</h3> <pre><code class=language-bash>Run git checkout -b gh-pages origin/gh-pages
fatal: 'origin/gh-pages' is not a commit and a branch 'gh-pages' cannot be created from it
##[error]Process completed with exit code 128.
</code></pre> <p>If you receive the above error, that means that the branch does not exist. When the repo is cloned, it only copies the master branch. If you want to have access to the other branches in the repository, then you will need ot perform a fetch and then checkout the branch of your choosing.</p> <p>You can add a fetch to your workflow by adding the below command:</p> <pre><code class=language-yaml>- name: Fetching branches
  run:  git fetch -p
</code></pre> <h3 id=gh-pages-or-deployment-branch-does-not-exist>gh-pages (or deployment) Branch Does Not Exist</h3> <pre><code class=language-bash>WARNING -  Version check skipped: No version specificed in previous deployment. 
INFO    -  Copying '/home/runner/work/almostengrwebsite/almostengrwebsite/site' to 'gh-pages' branch and pushing to GitHub. 
ERROR   -  Failed to deploy to GitHub with error: 
To https://github.com/almostengr/almostengrwebsite
 ! [rejected]        gh-pages -&gt; gh-pages (fetch first)
error: failed to push some refs to 'https://github.com/almostengr/almostengrwebsite'
hint: Updates were rejected because the remote contains work that you do
hint: not have locally. This is usually caused by another repository pushing
hint: to the same ref. You may want to first integrate the remote changes
hint: (e.g., 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.

##[error]Process completed with exit code 1.
</code></pre> <p>If you receive the above error, it is because the mkdocs gh-deploy command is trying to build and push the code into the same branch, which it should not.</p> <p>I added the following to my file, which resolved my issue.</p> <pre><code class=language-yaml>- name: Checking out gh-pages branch
  run:  git checkout -b gh-pages origin/gh-pages

- name: Checking out master branch
  run:  git checkout master

- name: Building static site
  run:  python -m mkdocs gh-deploy
</code></pre> <h2 id=conclusion>Conclusion</h2> <p>Before setting up GitHub actions, I was only able to make updates when I was at home as I only have my Development server configured for MkDocs.</p> <p>Even better is that this allows me to commit and publish from my phone.</p> <p>You can view my <a href=https://github.com/almostengr/almostengrwebsite/blob/master/.github/workflows/generate-static-pages.yml>Actions file</a> in the website repository.</p> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div><!-- /.blog-main --> <aside class="col-md-4 blog-sidebar"> <div class="p-4 mb-3 bg-light rounded shadow"> <h4 class=font-italic>About Kenny</h4> <p class=mb-0> A software developer that builds and fixes things, and writes about the journey. </p> </div> <div class="p-4 shadow mb-3"> <h4 class=font-italic>Get Into Tech</h4> <p class=mb-0> Are you looking to get into a tech career or role? Check out the <a href=/resources>Resources</a> section for more information. Also check out my <a href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1" target=_blank> Tech Talk YouTube Channel</a> and <a href="https://www.facebook.com/profile.php?id=100089303142244" target=_blank> Tech Talk Facebook page</a> for video tutorials about software development, web development, and working with tech. </a> </p> </div> <div class="p-4 shadow mb-3"> <h4 class=font-italic>Connect with Me</h4> <ol class=list-unstyled> <li><a target=_blank href=https://github.com/almostengr>Github</a></li> <li><a target=_blank href=https://facebook.com/rhtservicesllc>Home Improvement (Facebook)</a></li> <li><a target=_blank href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home Improvement (YouTube)</a></li> <li><a target=_blank href=https://instagram.com/almostengr>Instagram</a></li> <li><a target=_blank href=https://stackoverflow.com/users/12875554/almostengr>StackOverflow</a></li> <li><a target=_blank href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a></li> <li><a target=_blank href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk (YouTube)</a></li> <li><a target=_blank href=https://www.tiktok.com/@almostengr>TikTok</a></li> <li><a target=_blank href=https://twitter.com/almostengr>Twitter</a></li> </ol> </div> <div class="p-4 shadow mb-3"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </aside><!-- /.blog-sidebar --> </div><!-- /.row --> </main><!-- /.container --> <footer class="blog-footer bg-dark text-light text-left"> <div class=container> <div> <a class="text-light pr-2" href=/technology>Technology</a> <a class="text-light pr-2" href=/lifestyle>Living</a> <a class="text-light pr-2" href=/projects>Projects</a> <a class="text-light pr-2" href=/resources>Resources</a> <a class="text-light pr-2" href=/services>Services</a> <a class="text-light pr-2" href=/uses>Uses</a> <a class="text-light pr-2" href=/about>About</a> <a class="text-light pr-2" href=/contact>Contact</a> <a class="text-light pr-2" href=/about/privacy>Privacy Policy</a> <a class="text-light pr-2" href=/sitemap.xml>Sitemap</a> </div> <div> <a class="text-light pr-2" target=_blank href=https://facebook.com/rhtservicesllc>Home Improvement (Facebook)</a> <a class="text-light pr-2" target=_blank href="https://www.youtube.com/c/RobinsonHandyandTechnologyServices?sub_confirmation=1">Home Improvement (YouTube)</a> <a class="text-light pr-2" target=_blank href="https://www.facebook.com/profile.php?id=100089303142244">Tech Talk (Facebook)</a> <a class="text-light pr-2" target=_blank href="https://www.youtube.com/channel/UC4xp-TEEIAL-4XtMVvfRaQw?sub_confirmation=1">Tech Talk (YouTube)</a> </div> <div> <a class="text-light pr-2" target=_blank href=https://github.com/almostengr>Github</a> <a class="text-light pr-2" target=_blank href=https://instagram.com/almostengr>Instagram</a> <a class="text-light pr-2" target=_blank href=https://stackoverflow.com/users/12875554/almostengr>StackOverflow</a> <a class="text-light pr-2" target=_blank href=https://www.tiktok.com/@almostengr>TikTok</a> <a class="text-light pr-2" target=_blank href=https://twitter.com/almostengr>Twitter</a> </div> <div>Copyright &copy; 2010-2023 Kenny Robinson</div> <div> Created by <a class=text-light href=https://rhtservices.net target=_blank>Robinson Handy and Technology Services</a> </div> <div> Disclaimer: The opinions expressed here are those of mine and not representative of my employer or affiliates. </div> </div> </footer> </div> <script type=text/javascript src=/js/scripts.js></script> </body> </html>