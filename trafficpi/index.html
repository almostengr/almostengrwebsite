<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:site_name content="The Almost Engineer"><meta name=twitter:card content=summary><meta name=twitter:site content=@almostengr><meta name=twitter:creator content=@almostengr><meta name=description content="Project build using a Raspberry Pi to control a retired traffic light."><meta property=og:description content="Project build using a Raspberry Pi to control a retired traffic light."><meta name=twitter:description content="Project build using a Raspberry Pi to control a retired traffic light."><meta name=author content="Kenny Robinson, @almostengr"><title>Raspberry Pi Traffic Light Controller (TrafficPi) | The Almost Engineer, The blog of Kenny Robinson</title><meta property=og:title content="Raspberry Pi Traffic Light Controller (TrafficPi) | The Almost Engineer, The blog of Kenny Robinson"><meta name=twitter:title content="Raspberry Pi Traffic Light Controller (TrafficPi) | The Almost Engineer, The blog of Kenny Robinson"><meta property=og:type content=website><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/trafficpi/ rel=canonical><meta content=https://thealmostengineer.com/trafficpi/ property=og:url><meta content=https://thealmostengineer.com/trafficpi/ property=twitter:url><link href=/css/bootstrap.min.css rel=stylesheet><!-- Custom styles for this template --><link href="//fonts.googleapis.com/css?family=Playfair+Display:700,900" rel=stylesheet><link href=/css/theme.min.css rel=stylesheet><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/default.min.css><link rel=stylesheet href=/css/a11y-dark-theme.min.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.min.css><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest><!-- Global site tag (gtag.js) - Google Analytics --></head> <body class=bg-white> <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark-red"> <a class="navbar-brand font-weight-bold text-uppercase" href=/ title="The Almost Engineer, The blog of Kenny Robinson">The Almost Engineer</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav mr-auto"> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/technology>Technology</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/handyman>Handyman</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href="https://www.youtube.com/c/kennythealmostengineer?sub_confirmation=1">YouTube</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/projects>Projects</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/services>Services</a> </li> </ul> <form class="form-inline mt-2 mt-md-0" action=/search2> <button class="btn btn-outline-light my-sm-0" type=submit>Search</button> </form> </div> </nav> <main role=main class=container> <div class=row> <div class="col-sm-12 col-md-9 blog-main"> <ul class="list-unstyled breadcrumb"> <li class=list-inline-item><a href=/ >Home</a></li> <li class=list-inline-item>&raquo; <a href=..>Trafficpi</a></li> <li class=list-inline-item>&raquo; Raspberry Pi Traffic Light Controller (TrafficPi)</li> </ul> <h1 class=blog-post-title> Raspberry Pi Traffic Light Controller (TrafficPi) </h1> <!-- home page listing --> <p> </p> <div class=content> <p><img alt="Traffic light" src=/images/portfolio_trafficlight2.jpg></p> <h2 id=table-of-contents>Table of Contents</h2> <ul> <li><a href=#purpose>Purpose</a></li> <li><a href=#parts-list>Parts List</a></li> <li><a href=#installation-and-setup>Installation and Setup</a></li> <li><a href=#video-demonstration>Video Demonstration</a></li> <li><a href=#controller-technology>Controller Technology</a></li> <li><a href=#uninstall-traffic-pi>Uninstall Traffic Pi</a></li> <li><a href=#acknowledgements>Acknowledgements</a></li> <li><a href=#troubleshooting>Troubleshooting</a></li> <li><a href=/trafficpi/activity>Classroom Activity</a></li> <li><a href=/trafficpi/electriclatheory>Electrical Theory</a></li> </ul> <h2 id=purpose>Purpose</h2> <p>The purpose of this project is to educate children about the STEM (Science, Technology, Engineering, and Mathematics) fields. Through the use of low cost devices and effective teaching, children are able to associate what they are learning with interactions with everyday items. For example, most future engineers are aware of the purpose of a traffic light, but most are not aware of a traffic lights' internal workings. This project is designed to educate future engineers about the impact that computers and computer programming has with society. This project targets the "T, E, and M" of "STEM" by using electronic circuits for controlling the lights, software for controlling the electronic circuits, and mathematical calculations for making timing decisions.</p> <h3 id=teach-software-versioning>Teach Software Versioning</h3> <p>One of the goals of this project is to be able to teach the next generation of engineers about the programming, software versioning, and how valuable engineers and technologists are to society and the impact that they have. A game was developed to be combined with this project to teach about software versioning, how sometimes Software Developers don't get it right the first time, and the negative impact that can occur if they don't get it right the first time.</p> <p>Below is the image of a group of future engineers working their way to developing the psuedocode for a normal traffic cycle. As shown in the first version, all of the lights turned on but never turned off. In the final version, they figured out that they had to turn on and turn off each light as well as include a delay in between each light change.</p> <p><img alt="Image of Versioning" src=/images/trafficpi/versioning.jpg></p> <p><a href=#>Back to Top</a></p> <h2 id=parts-list>Parts List</h2> <p>Below are the list of parts used for this project. You'll need to choose one of the mentioned options below depending on your budget. Using LEDs is cheaper than getting an actual traffic light.</p> <ul> <li><a href="https://www.amazon.com/gp/product/B07BC7BMHY/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B07BC7BMHY&linkId=b51d201ecdca3bed2a84249448d0dd4f" target=_blank>Raspiberry Pi 3 Kit</a> (May work on other models, but has only been tested on Raspberry Pi 3)</li> <li><a href="https://www.amazon.com/gp/product/B08GYKNCCP/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B08GYKNCCP&linkId=1e440b7afda77da0a25f2af4d65b8b6a" target=_blank>Micro SD card</a> (to run the OS and store project files)</li> <li><a href="https://www.amazon.com/gp/product/B07RQVB3HQ/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B07RQVB3HQ&linkId=8452f5455a39f35597424dcc8a2ae388" target=_blank>USB keyboard</a> (mouse optional)</li> <li>HDMI display</li> <li><a href="https://www.amazon.com/gp/product/B07GD25V8D/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B07GD25V8D&linkId=ea5fb3393909abe778b518e808e674d5" target=_blank>Breadboard Jumper Cables</a></li> <li><a href="https://www.amazon.com/gp/product/B07PCJP9DY/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B07PCJP9DY&linkId=dca65d5d374944f5c1d213924d2fb183" target=_blank>Breadboard</a> (optional)</li> <li>Python 2.7.9 (May work with later versions, but has only been tested with 2.7.9)</li> <li>Raspberry Pi OS Jessie, Stretch, or Buster (May work on other OSs, but has only been tested with Raspberry Pi OS Jessie)</li> </ul> <h3 id=led-option>LED Option</h3> <ul> <li><a href="https://www.amazon.com/gp/product/B06XPV4CSH/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B06XPV4CSH&linkId=ab8747a23cf5b35f3e83190c54cacd36" target=_blank>Red LED</a></li> <li><a href="https://www.amazon.com/gp/product/B06XPV4CSH/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B06XPV4CSH&linkId=ab8747a23cf5b35f3e83190c54cacd36" target=_blank>Yellow LED</a></li> <li><a href="https://www.amazon.com/gp/product/B06XPV4CSH/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B06XPV4CSH&linkId=ab8747a23cf5b35f3e83190c54cacd36" target=_blank>Green LED</a></li> </ul> <h3 id=real-traffic-light-option>Real Traffic Light Option</h3> <ul> <li><a href="https://www.amazon.com/gp/product/B00KTEN3TM/ref=as_li_tl?ie=UTF8&tag=rhtservicesll-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B00KTEN3TM&linkId=581b0fc60dcc9f3ddc5645b8eb20029a" target=_blank>Relay board(s) with at least 3 channels</a></li> <li>Traffic Light</li> </ul> <p><a href=#>Back to Top</a></p> <h2 id=installation-and-setup>Installation and Setup</h2> <h3 id=install-raspberry-pi-os>Install Raspberry Pi OS</h3> <p>You will need to install Raspberry Pi OS on your SD. Once you have completed this install, Then you can insert the SD card into the Raspberry Pi and power it on.</p> <p>To install Raspberry Pi OS using Ubuntu, I made a video tutorial which you can watch at <a href="https://www.youtube.com/watch?v=Wy1_MWWlkNI">https://www.youtube.com/watch?v=Wy1_MWWlkNI</a>.</p> <h3 id=pin-setup>Pin Setup</h3> <p>Below is the mapping for the connections to the Raspberry Pi. The Pin numbers listed are the physical pin numbers on the board, not the GPIO pin numbers. If you are not using a relay board, the connections can be made directly to a breadboard with LEDs connected.</p> <table> <thead> <tr> <th>Pi Pin (Board)</th> <th>GPIO</th> <th>Device Connection</th> </tr> </thead> <tbody> <tr> <td>2</td> <td>--</td> <td>LCD Display VCC (+5V)</td> </tr> <tr> <td>3</td> <td>--</td> <td>LCD Display SDA</td> </tr> <tr> <td>4</td> <td>--</td> <td>Relay Board VCC (+5V)</td> </tr> <tr> <td>5</td> <td>--</td> <td>LCD Display SLC</td> </tr> <tr> <td>19</td> <td>11</td> <td>Red Signal</td> </tr> <tr> <td>21</td> <td>9</td> <td>Yellow Signal</td> </tr> <tr> <td>23</td> <td>10</td> <td>Green Signal</td> </tr> <tr> <td>30</td> <td>--</td> <td>LCD Display GND</td> </tr> <tr> <td>34</td> <td>--</td> <td>Relay Board GND</td> </tr> </tbody> </table> <h4 id=visual-of-pin-connections-to-relay-board>Visual of Pin Connections to Relay Board</h4> <p><img alt="Image of connections on Raspberry Pi board" src=/images/trafficpi/circuitry.jpg></p> <h3 id=system-service>System Service</h3> <p>To set up the application as a service, run the below commands. If you see error messages when running the commands, you may need to run them with "sudo" privileges. See the <a href=/trafficpi/systemservice>System Service</a> page for details on how to add or remove the application as a system service.</p> <h4 id=create-system-service>Create System Service</h4> <pre><code class=language-sh>sudo cp almostengrtrafficpiweb.service /lib/systemd/system
sudo systemctl daemon-reload
sudo systemctl enable almostengrtrafficpiweb.service
sudo systemctl start almostengrtrafficpiweb.service
sudo systemctl status almostengrtrafficpiweb.service
</code></pre> <h4 id=run-app-on-pi>Run App On Pi</h4> <p>To run the applicatoin via the command line (not using the system service), then you can run the commands below.</p> <pre><code class=language-sh>cd trafficpi
./Almostengr.TrafficPi.Web
</code></pre> <p>To exit the application after running it via command line, press Ctrl+C.</p> <p><a href=#>Back to Top</a></p> <h2 id=video-demonstration>Video Demonstration</h2> <p>Video demonstration of version 1.0 of the project is available to be watched at <a href="https://www.youtube.com/watch?v=lr_ZJNX0viM" target=_blank>https://www.youtube.com/watch?v=lr_ZJNX0viM</a>. This version of the demonstration of the traffic light working with an LCD screen connected.</p> <p>Further discussion of the traffic light code can be watched at <a href="https://www.youtube.com/watch?v=ZyBnWOX3wGE">https://www.youtube.com/watch?v=ZyBnWOX3wGE</a>.</p> <p><a href=#>Back to Top</a></p> <h2 id=controller-technology>Controller Technology</h2> <p>The controller currently uses .NET Core 3.1. Tt is a multi-project application.</p> <h3 id=user-interface-ui-front-end>User Interface (UI) / Front End</h3> <p>The user interface is a .NET Core MVC application. When you select the program that you want to run from the application home page, the application then runs a linux command that runs the back end program.</p> <p>When the program is changed on the front end, the back end program is then terminated and the newly select program is started.</p> <h3 id=relay-control-back-end>Relay Control / Back End</h3> <p>The back end of the application is a .NET Core Worker Service. The program modes are defined within this worker service. The worker service will continue running until it is terminated by the front end application or by a user via the command line or SSH.</p> <h3 id=source-code>Source Code</h3> <p>The source code for this project can be downloaded from GitHub at <a href=https://github.com/almostengr/trafficpi target=_blank> https://github.com/almostengr/trafficpi</a>.</p> <p><a href=#>Back to Top</a></p> <h2 id=uninstall-traffic-pi>Uninstall Traffic Pi</h2> <h3 id=remove-system-service>Remove System Service</h3> <p>To remove the application as a system service, run each of the commands below.</p> <pre><code class=language-sh>sudo systemctl disable almostengrtrafficpiweb.service
sudo systemctl stop almostengrtrafficpiweb.service
sudo systemctl status almostengrtrafficpiweb.service
sudo rm /lib/systemd/system/almostengrtrafficpiweb.service
</code></pre> <p>After running all of the commands above, then reboot the system.</p> <h3 id=application-files>Application Files</h3> <p>To remove the application files, you can remove the entire trafficpi directory.</p> <pre><code class=language-sh>rm -rf trafficpi
</code></pre> <p><a href=#>Back to Top</a></p> <h2 id=acknowledgements>Acknowledgements</h2> <ul> <li>LCD Display code for controlling the LCD display were provided from <a href=https://github.com/the-raspberry-pi-guy/lcd target=_blank>https://github.com/the-raspberry-pi-guy/lcd</a>.</li> <li>Attempts to replicate the Traffic Light Simulation created by Samuel Vidal seen at <a href="https://www.youtube.com/watch?v=xqZRDtX64UA" target=_blank>https://www.youtube.com/watch?v=xqZRDtX64UA</a> influenced this project.</li> <li>Wifi AP configuration steps provided by <a href=https://pimylifeup.com/raspberry-pi-wireless-access-point/ target=_blank>https://pimylifeup.com/raspberry-pi-wireless-access-point/</a></li> </ul> <p><a href=#>Back to Top</a></p> <h2 id=troubleshooting>Troubleshooting</h2> <h3 id=system-service-output-log>System Service Output / Log</h3> <p>To see the logged output from the system service, run the command:</p> <pre><code class=language-sh>journalctl -u almostengrtrafficpiweb.service -b
</code></pre> <p>or</p> <pre><code class=language-sh>journalctl -u almostengrtrafficpiweb.service -b -f
</code></pre> <p>If an error occurs in the application, the exception message will show here.</p> <p><a href=#>Back to Top</a></p> <div class=pb-3> <a class=a2a_dd href=https://www.addtoany.com/share> <img src=https://static.addtoany.com/buttons/share_save_171_16.png height=16 alt=Share> </a> </div> <!-- mobile page links --> </div> <!--  --> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div><!-- /.blog-main --> <aside class="col-md-3 blog-sidebar"> <div class="card mb-3"> <div class="card-header bg-black text-white text-center"> <h4 style="border: 0px;">Online Courses</h4> </div> <div class="card-body bg-light"> <ul class=list-unstyled> <li><a class=text-decoration-none href="https://www.youtube.com/watch?v=iujOWWbiUP0&list=PLaAJ0fv0d9WM8E2K_Ke5As-fw626yQ3tu" target=_blank> <i class></i> Drupal 8 Basics<br>FREE COURSE!</a></li> </ul> </div> </div> <div class="card mb-3"> <div class="card-header bg-black text-white text-center"> <h4 style="border: 0px;">Share This</h4> </div> <div class="card-body bg-light"> <a class=a2a_dd href=https://www.addtoany.com/share> <img src=https://static.addtoany.com/buttons/share_save_171_16.png height=16 alt=Share> </a> </div> </div> <div class="p-1 mb-3"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> <div class="p-1 mb-3"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </aside><!-- /.blog-sidebar --> </div><!-- /.row --> <p class=text-center><a href=#>Back To Top</a></p> </main><!-- /.container --> <footer class="blog-footer bg-black  text-left p-2"> <div class=container> <div class=row> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold rounded"> SOCIAL </li> <li class=px-3> <a href=https://github.com/almostengr><i class="bi bi-github"></i> GitHub</a> </li> <li class=px-3> <a href=https://www.instagram.com/almostengr><i class="bi bi-instagram"></i> Instagram</a> </li> <li class=px-3> <a href=https://twitter.com/almostengr><i class="bi bi-twitter"></i> Twitter</a> </li> <li class=px-3> <a href="https://www.youtube.com/c/kennythealmostengineer?sub_confirmation=1"><i class="bi bi-youtube"></i> YouTube</a> </li> </ul> </div> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold rounded"> BLOG </li> <li class=px-3> <a href=/technology><i class="bi bi-journal-text"></i> Technology</a> </li> <li class=px-3> <a href=/handyman><i class="bi bi-journal-text"></i> Handyman</a> </li> <li class=px-3> <a href=/gardening><i class="bi bi-journal-text"></i> Gardening</a> </li> <li class=px-3> <a href=/lifestyle><i class="bi bi-journal-text"></i> Lifestyle</a> </li> <li class=px-3> <a href=/cookbook><i class="bi bi-journal-text"></i> Cookbook</a> </li> </ul> </div> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold rounded"> PROJECTS </li> <li class=px-3> <a href=/lightshow><i class="bi bi-lightbulb"></i> Christmas Light Show</a> </li> <li class=px-3> <a href=/falconpitwitter><i class="bi bi-cpu-fill"></i> Falcon Pi Twitter</a> </li> <li class=px-3> <a href=/resources><i class="bi bi-bookshelf"></i> Resources</a> </li> <li class=px-3> <a href=/speaking><i class="bi bi-megaphone-fill"></i> Speaking</a> </li> <li class=px-3> <a href=/trafficpi><i class="bi bi-stoplights"></i> Traffic Pi</a> </li> <li class=px-3> <a href=/projects><i class="bi bi-journal"></i> All Projects</a> </li> </ul> </div> <div class="col-sm-12 col-lg-3"> <ul class=list-unstyled> <li class="bg-white text-dark px-2 mb-1 font-weight-bold rounded"> LINKS </li> <li class=px-3> <a href=/services><i class="bi bi-briefcase"></i> Services</a> </li> <li class=px-3> <a href=/about><i class="bi bi-file-person-fill"></i> About</a> </li> <li class=px-3> <a href=/uses><i class="bi bi-tools"></i> Uses (Tools Used)</a> </li> <li class=px-3> <a href=/contact><i class="bi bi-person-lines-fill"></i> Contact</a> </li> <li class=px-3> <a href=/sitemap.xml><i class="bi bi-diagram-3"></i> Sitemap</a> </li> <li class=px-3> <a href=/privacy><i class="bi bi-shield-shaded"></i> Privacy</a> </li> </ul> </div> </div> <p class=text-center> Copyright &copy; 2021 Kenny Robinson | Website built and maintained by <a href=https://rhtservices.net target=_blank>Robinson Handy and Technology Services LLC</a> </p> <p class=text-center> Cookies are used on this website to track your visits, provide advertisements specific to you, and preferences by a third-party. By continuing to use this site, you agree to the use of cookies unless you have disabled them. More information this is available in the <a href=/privacy>Privacy Policy</a>.<br> Build Date UTC : 2021-07-01 11:25:01.496746+00:00 </p> </div> </footer> <script src=//code.jquery.com/jquery-3.5.1.slim.min.js async integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script> <script>window.jQuery || document.write('<script src="/js/vendor/jquery.slim.min.js"><\/script>')</script> <script async src=/js/bootstrap.bundle.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js></script> <script src=/js/theme.min.js defer></script> <script>let getUrl = window.location; var base_url = getUrl.protocol + "//" + getUrl.host + "/";</script> <script src=/search/main.js defer></script> <script>hljs.initHighlightingOnLoad();</script> <script type=text/javascript async>var a2a_config = a2a_config || {}; a2a_config.onclick = 1;</script> <script async src=https://static.addtoany.com/menu/page.js></script> </body> </html>