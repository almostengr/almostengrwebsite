<!doctype html><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:site_name content="The Almost Engineer"><meta name=twitter:card content=summary><meta name=twitter:site content=@almostengr><meta name=twitter:creator content=@almostengr><meta name=description content="Project build using a Raspberry Pi to control a retired traffic light."><meta property=og:description content="Project build using a Raspberry Pi to control a retired traffic light."><meta name=twitter:description content="Project build using a Raspberry Pi to control a retired traffic light."><meta name=author content="Kenny Robinson, @almostengr"><title>Raspberry Pi Traffic Light Controller (TrafficPi) | The Almost Engineer</title><meta property=og:title content="Raspberry Pi Traffic Light Controller (TrafficPi) | The Almost Engineer"><meta name=twitter:title content="Raspberry Pi Traffic Light Controller (TrafficPi) | The Almost Engineer"><meta property=og:type content=website><meta name=robots content="index, follow"><link href=https://thealmostengineer.com/trafficpi/ rel=canonical><meta content=https://thealmostengineer.com/trafficpi/ property=og:url><meta content=https://thealmostengineer.com/trafficpi/ property=twitter:url><link href=/css/bootstrap.min.css rel=stylesheet><!-- Custom styles for this template --><link href="//fonts.googleapis.com/css?family=Playfair+Display:700,900" rel=stylesheet><link href=/css/theme.min.css rel=stylesheet><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/default.min.css><link rel=stylesheet href=/css/a11y-dark-theme.min.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.min.css><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest><!-- Global site tag (gtag.js) - Google Analytics --><script async src="//www.googletagmanager.com/gtag/js?id=UA-64643711-1"></script><script async>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date()); gtag('config', 'UA-64643711-1');</script></head> <body> <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark-red"> <a href=/ class="navbar-brand font-weight-bold text-uppercase">The Almost Engineer</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse> <ul class="navbar-nav mr-auto"> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/technology>Technology</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/handyman>Handyman</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/gardening>Gardening</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/projects>Projects</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/resources>Resources</a> </li> <li class=nav-item> <a class="nav-link text-white text-uppercase" href=/uses>Uses</a> </li> </ul> <form class="form-inline mt-2 mt-md-0" action=/search2> <button class="btn btn-outline-light my-2 my-sm-0" type=submit>Search</button> </form> </div> </nav> <div class="pt-3 mt-0 bg-white"> <main role=main class=container> <div class=row> <div class="col-sm-12 col-md-9 blog-main"> <ul class="list-unstyled  breadcrumb "> <li class=list-inline-item><a href=/ >Home</a></li> <li class=list-inline-item>&raquo; <a href=..>Trafficpi</a></li> <li class=list-inline-item>&raquo; Raspberry Pi Traffic Light Controller (TrafficPi)</li> </ul> <h1 class=blog-post-title> Raspberry Pi Traffic Light Controller (TrafficPi) </h1> <p class="text-center blog-post-meta text-secondary"> <em> </em> </p> <!-- home page listing --> <p><ul class=list-unstyled> </ul><ul class=list-unstyled> </ul><ul class=list-unstyled> </ul><ul class=list-unstyled> </ul></p> <div class=content> <p><img alt="Traffic light" src=/images/portfolio_trafficlight2.jpg></p> <h2 id=table-of-contents>Table of Contents</h2> <ul> <li><a href=#purpose>Purpose</a></li> <li><a href=#activities>Activities</a></li> <li><a href=#parts-list>Parts List</a></li> <li><a href=#source-code>Source Code</a></li> <li><a href=#pin-setup>Pin Setup</a></li> <li><a href=#initial-setup>Initial Setup</a></li> <li><a href=#running-the-scripts>Running the Scripts</a></li> <li><a href=#uninstall-script>Uninstall Script</a></li> <li><a href=#bug-reports-and-road-map>Bug Reports and Road Map</a></li> <li><a href=#known-bugs>Known Bugs</a></li> <li><a href=#acknowledgements>Acknowledgements</a></li> </ul> <h2 id=purpose>Purpose</h2> <p>The purpose of this project is to educate children about the STEM (Science, Technology, Engineering, and Mathematics) fields. Through the use of low cost devices and effective teaching, children are able to associate what they are learning with interactions with everyday items. For example, most future engineers are aware of the purpose of a traffic light, but most are not aware of a traffic lights' internal workings. This project is designed to educate future engineers about the impact that computers and computer programming has with society. This project targets the "T, E, and M" of "STEM" by using electronic circuits for controlling the lights, software for controlling the electronic circuits, and mathematical calculations for making timing decisions.</p> <h2 id=activities>Activities</h2> <p>There is a <a href=/trafficpi/exercise>classroom activity</a> that can be done with students to demonstrate the importance of programming coding the traffic light correctly.</p> <h3 id=teach-software-versioning>Teach Software Versioning</h3> <p>One of the goals of this project is to be able to teach the next generation of engineers about the programming, software versioning, and how valuable engineers and technologists are to society and the impact that they have. A game was developed to be combined with this project to teach about software versioning, how sometimes Software Developers don't get it right the first time, and the negative impact that can occur if they don't get it right the first time.</p> <p>Below is the image of a group of future engineers working their way to developing the psuedocode for a normal traffic cycle. As shown in the first version, all of the lights turned on but never turned off. In the final version, they figured out that they had to turn on and turn off each light as well as include a delay in between each light change.</p> <p><img alt="Image of Versioning" src=/images/trafficpi/versioning.jpg></p> <h3 id=video-demonstration>Video Demonstration</h3> <p>Video demonstration of version 1.0 of the project is available to be watched at <a href="https://www.youtube.com/watch?v=lr_ZJNX0viM" target=_blank>https://www.youtube.com/watch?v=lr_ZJNX0viM</a>. This version of the demonstration of the traffic light working with an LCD screen connected.</p> <h2 id=parts-list>Parts List</h2> <p>Below are the list of parts used for this project. You'll need to choose one of the mentioned options below depending on your budget. Using LEDs is cheaper than getting an actual traffic light.</p> <ul> <li><a href="https://www.amazon.com/gp/product/B01CD5VC92/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B01CD5VC92&linkCode=as2&tag=almostengr-20&linkId=b25e1b38c2c187404a50b967837af72b" target=_blank>Raspiberry Pi 3</a> (May work on other models, but has only been tested on Raspberry Pi 3)</li> <li><a href="https://www.amazon.com/gp/product/B00MARDJZ4/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B00MARDJZ4&linkId=d8a07d1f200ba168b5fd5a49d4bb8afa" target=_blank>Raspiberry Pi power supply</a></li> <li><a href=https://amzn.to/2IcYREu target=_blank>Micro SD card</a> (to run the OS and store project files)</li> <li><a href=https://amzn.to/2tfNnpE target=_blank>USB keyboard</a> (mouse optional)</li> <li>HDMI display</li> <li><a href="https://www.amazon.com/gp/product/B07D83DY17/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B07D83DY17&linkId=e283038ab1f79e840b5d893586a38e19" target=_blank>I2C 16x2 LCD Display</a></li> <li><a href="https://www.amazon.com/gp/product/B07GD2BWPY/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B07GD2BWPY&linkId=c3042114933e20a073b88c0947756efd" target=_blank>Breadboard Jumper Cables</a></li> <li><a href="https://www.amazon.com/gp/product/B01EV6LJ7G/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B01EV6LJ7G&linkId=d6d36ad3de7629f3e963d620893c4ee3" target=_blank>Breadboard</a> (optional)</li> <li>Python 2.7.9 (May work with later versions, but has only been tested with 2.7.9)</li> <li>Raspbian Jessie, Stretch, or Buster (May work on other OSs, but has only been tested with Raspbian Jessie)</li> </ul> <h3 id=led-option>LED Option</h3> <ul> <li><a href="https://www.amazon.com/gp/product/B0765NKCZ4/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B0765NKCZ4&linkId=0beb817f2435922b5666155b94430ecc" target=_blank>Red LED</a></li> <li><a href="https://www.amazon.com/gp/product/B0765NKCZ4/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B0765NKCZ4&linkId=0beb817f2435922b5666155b94430ecc" target=_blank>Yellow LED</a></li> <li><a href="https://www.amazon.com/gp/product/B0765NKCZ4/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B0765NKCZ4&linkId=0beb817f2435922b5666155b94430ecc" target=_blank>Green LED</a></li> </ul> <h3 id=real-traffic-light-option>Real Traffic Light Option</h3> <ul> <li><a href="https://www.amazon.com/gp/product/B00KTEN3TM/ref=as_li_tl?ie=UTF8&tag=almostengr-20&camp=1789&creative=9325&linkCode=as2&creativeASIN=B00KTEN3TM&linkId=1178d5b941f8f41f5bc23fc6da317cf0" target=_blank>Relay board(s) with at least 3 channels</a></li> <li>Traffic Light</li> </ul> <h2 id=source-code>Source Code</h2> <p>The source code for this project can be downloaded from GitHub at <a href=https://github.com/almostengr/raspitraffic-stem target=_blank> https://github.com/almostengr/raspitraffic-stem</a>.</p> <h2 id=pin-setup>Pin Setup</h2> <p>Below is the mapping for the connections to the Raspberry Pi. The Pin numbers listed are the physical pin numbers on the board, not the GPIO pin numbers. If you are not using a relay board, the connections can be made directly to a breadboard with LEDs connected.</p> <table> <thead> <tr> <th>Pi Pin (Board)</th> <th>GPIO</th> <th>Device Connection</th> </tr> </thead> <tbody> <tr> <td>2</td> <td>--</td> <td>LCD Display VCC (+5V)</td> </tr> <tr> <td>3</td> <td>--</td> <td>LCD Display SDA</td> </tr> <tr> <td>4</td> <td>--</td> <td>Relay Board VCC (+5V)</td> </tr> <tr> <td>5</td> <td>--</td> <td>LCD Display SLC</td> </tr> <tr> <td>19</td> <td>11</td> <td>Red Signal</td> </tr> <tr> <td>21</td> <td>9</td> <td>Yellow Signal</td> </tr> <tr> <td>23</td> <td>10</td> <td>Green Signal</td> </tr> <tr> <td>30</td> <td>--</td> <td>LCD Display GND</td> </tr> <tr> <td>34</td> <td>--</td> <td>Relay Board GND</td> </tr> </tbody> </table> <p>Visual of Pin Connections to Relay Board</p> <p><img alt="Image of connections on Raspberry Pi board" src=/images/trafficpi/circuitry.jpg></p> <h2 id=demostrations-and-video-discusssions>Demostrations and Video Discusssions</h2> <p>These demostration videos show the traffic in one of several operating modes.</p> <p><a href="https://www.youtube.com/watch?v=lr_ZJNX0viM">Raspberry PI Traffic Light Controller Demonstration</a></p> <p><a href="https://www.youtube.com/watch?v=ZyBnWOX3wGE">Discussing the Traffic Light Code</a></p> <h2 id=initial-setup>Initial Setup</h2> <h3 id=install-raspbian>Install Raspbian</h3> <p>You will need to install Raspbian on your SD. Once you have completed this install, Then you can insert the SD card into the Raspberry Pi and power it on.</p> <p>To install Raspbian using Ubuntu, I made a video tutorial which you can watch at <a href="https://www.youtube.com/watch?v=Wy1_MWWlkNI">https://www.youtube.com/watch?v=Wy1_MWWlkNI</a>.</p> <h3 id=install-script>Install Script</h3> <p>In the <code>scripts</code> directory, run the <code>install.sh</code> script as root user. This will install of the required software and python packages.</p> <h3 id=update-apache-configuration>Update Apache Configuration</h3> <p>Search for the file containing "PrivateTmp=true". This file should be in your /etc directory. Change this value to <code>PrivateTmp=false</code>. Then restart Apache. You may use</p> <pre><code class=language-sh>cd /etc/
grep -R &quot;PrivateTmp=true&quot; *
</code></pre> <p>to search for the file that contains this value. Once grep returns the file name, edit the file and make the stated change.</p> <h2 id=running-the-scripts>Running The Scripts</h2> <p>To control the traffic light, run the raspitraffic.py script via command line.</p> <pre><code class=language-sh>python raspitraffic.py
</code></pre> <p>Then visit the webpage to your TrafficPi in a web browser. A form will be presented with a list of programs to select from. Select the program you wish to run and click the "Submit" button.</p> <p>If a program is already running, the newly selected program will start once the end of the current program has been reached. If no program has been selected, the newly selected program will start immediately.</p> <h3 id=pseudocode-program>Pseudocode Program</h3> <p>The Pseudocode Program allows you to write your own program for controlling the traffic light. On the Control Panel webpage, enter each command that you want the light to perform on a line by itself in the "Pseudocode Commands" textbox. The list of commands are listed on the Control Panel webpage below the textbox.</p> <h2 id=move-and-run-code-on-the-pi>Move and Run Code on the Pi</h2> <h3 id=software-to-install-on-pi>Software to Install on Pi</h3> <p>Run these commands to install the necessary software on the Pi. You only need to do them once.</p> <pre><code class=language-sh>sudo apt-get update
sudo apt-get install curl libunwind8 gettext apt-transport-https
</code></pre> <h3 id=publish-your-app>Publish Your App</h3> <p>Then run the publish command on your app</p> <pre><code class=language-sh>dotnet publish -r linux-arm
</code></pre> <h3 id=copy-the-files>Copy the Files</h3> <p>Then copy the files from your computer to the Pi. I used SSH for this.</p> <pre><code class=language-sh>scp -pr bin/Debug/netcoreapp3.1/linux-arm/publish/* pi@trafficpi://home/pi/rpidotnet
</code></pre> <h3 id=run-app-on-pi>Run App On Pi</h3> <p>Run the program by calling the executable. This filename will be the name of your project.</p> <pre><code class=language-sh>./rpidotnet
</code></pre> <h2 id=troubleshooting>Troubleshooting</h2> <ul> <li>If your app does not run, make sure that execute permissions have been set for all roles (755).</li> </ul> <h2 id=acknowledgements>Acknowledgements</h2> <ul> <li>LCD Display code for controlling the LCD display were provided from <a href=https://github.com/the-raspberry-pi-guy/lcd target=_blank>https://github.com/the-raspberry-pi-guy/lcd</a>.</li> <li>Attempts to replicate the Traffic Light Simulation created by Samuel Vidal seen at <a href="https://www.youtube.com/watch?v=xqZRDtX64UA" target=_blank>https://www.youtube.com/watch?v=xqZRDtX64UA</a> influenced this project.</li> <li>Wifi AP configuration steps provided by <a href=https://pimylifeup.com/raspberry-pi-wireless-access-point/ target=_blank>https://pimylifeup.com/raspberry-pi-wireless-access-point/</a></li> </ul> <!-- mobile page links --> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </div><!-- /.blog-main --> <aside class="col-md-3 blog-sidebar"> <div class="p-4 mb-3 bg-light rounded"> <h4 class=font-italic>Categories</h4> <ol class=list-unstyled> <li><a href=/handyman><i class="bi bi-wrench"></i> DIY/Handyman</a></li> <li><a href=/technology><i class="bi bi-laptop"></i> Technology</a></li> <li><a href=/lightshow><i class="bi bi-lightbulb"></i> Christmas Light Show</a></li> <li><a href=/falconpimonitor><i class="bi bi-cpu-fill"></i> Falcon Pi Monitor</a></li> <li><a href=/trafficpi><i class="bi bi-stoplights"></i> Traffic Pi</a></li> <li><a href=/speaking><i class="bi bi-megaphone-fill"></i> Speaking</a></li> <li><a href=/gardening><i class="bi bi-flower1"></i> Gardening</a></li> <li><a href=/lifestyle><i class="bi bi-person"></i> Lifestyle</a></li> <li><a href=/resources><i class="bi bi-bookshelf"></i> Resources</a></li> <li><a href=/projects><i class="bi bi-journal"></i> Projects</a></li> </ol> </div> <div class="p-4 mb-3 bg-light rounded"> <h4 class=font-italic>Connect With Me</h4> <ol class=list-unstyled> <li><a href=https://github.com/almostengr target=_blank><i class="bi bi-github"></i> GitHub</a></li> </svg> <li><a href=https://instagram.com/almostengr target=_blank><i class="bi bi-instagram"></i> Instagram</a></li> </svg> <li><a href=https://www.linkedin.com/in/krobinsontech target=_blank><i class="bi bi-linkedin"></i> LinkedIn</a></li> </svg> <li><a href=https://twitter.com/almostengr target=_blank><i class="bi bi-twitter"></i> Twitter</a></li> </svg> <li><a href="https://www.youtube.com/channel/UC4HCouBLtXD1j1U_17aBqig?sub_confirmation=1" target=_blank><i class="bi bi-youtube" &quot;></i> YouTube</a></li> </svg> </ol> </div> <div class="p-4 mb-3 bg-light rounded"> <h4 class=font-italic>Online Courses</h4> <ol class=list-unstyled> <li><a href="https://www.youtube.com/watch?v=iujOWWbiUP0&list=PLaAJ0fv0d9WM8E2K_Ke5As-fw626yQ3tu" target=_blank><i class></i> Drupal 8 Basics</a></li> </svg> </ol> </div> <div class="p-4 mb-3 bg-light rounded"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> <div class="p-4 mb-3 bg-light rounded"> <script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-4218270188842097 data-ad-slot=5189305512 data-ad-format=auto data-full-width-responsive=true></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </div> </aside><!-- /.blog-sidebar --> </div><!-- /.row --> </main><!-- /.container --> </div> <footer class="blog-footer bg-black container text-left"> <p class=text-center><a href=#>Back To Top</a></p> <ul class=list-unstyled> <li class="list-inline-item bg-white text-dark px-2 font-weight-bold"> SOCIAL </li> <li class=list-inline-item> <a href=https://github.com/almostengr><i class="bi bi-github"></i> GitHub</a> </li> <li class=list-inline-item> <a href=https://instagram.com/almostengr><i class="bi bi-instagram"></i> Instagram</a> </li> <li class=list-inline-item> <a href=https://www.linkedin.com/in/krobinsontech><i class="bi bi-linkedin"></i> LinkedIn</a> </li> <li class=list-inline-item> <a href=https://twitter.com/almostengr><i class="bi bi-twitter"></i> Twitter</a> </li> <li class=list-inline-item> <a href="https://www.youtube.com/channel/UC4HCouBLtXD1j1U_17aBqig?sub_confirmation=1"><i class="bi bi-youtube"></i> YouTube</a> </li> </ul> <ul class=list-unstyled> <li class="list-inline-item bg-white text-dark px-2 font-weight-bold"> LINKS </li> <li class=list-inline-item> <a href=/lightshow><i class="bi bi-lightbulb"></i> Christmas Light Show</a> </li> <li class=list-inline-item> <a href=/trafficpi><i class="bi bi-stoplights"></i> Traffic Pi</a> </li> <li class=list-inline-item> <a href=/about><i class="bi bi-file-person-fill"></i> About</a> </li> <li class=list-inline-item> <a href=/uses><i class="bi bi-tools"></i> Uses</a> </li> <li class=list-inline-item> <a href=/technology><i class="bi bi-journal-text"></i> Technology</a> </li> <li class=list-inline-item> <a href=/handyman><i class="bi bi-journal-text"></i> Handyman</a> </li> <li class=list-inline-item> <a href=/contact><i class="bi bi-person-lines-fill"></i> Contact</a> </li> <li class=list-inline-item> <a href=/sitemap.xml><i class="bi bi-diagram-3"></i> Sitemap</a> </li> <li class=list-inline-item> <a href=/privacy><i class="bi bi-shield-shaded"></i> Privacy</a> </li> </ul> <p> Copyright &copy; 2021 Kenny Robinson | Website built and maintained by <a href=https://rhtservices.net target=_blank>Robinson Handy and Technology Services LLC</a> </p> <p> Cookies are used on this website to track your visits, provide advertisements specific to you, and preferences by a third-party. By continuing to use this site, you agree to the use of cookies unless you have disabled them. More information this is available in the <a href=/privacy>Privacy Policy</a>. </p> </footer> <script src=//code.jquery.com/jquery-3.5.1.slim.min.js async integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script> <script>window.jQuery || document.write('<script src="/js/vendor/jquery.slim.min.js"><\/script>')</script> <script async src=/js/bootstrap.bundle.min.js></script> <script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js></script> <script src=/js/theme.min.js defer></script> <script>let getUrl = window.location; var base_url = getUrl.protocol + "//" + getUrl.host + "/";</script> <script src=/search/main.js defer></script> <script>hljs.initHighlightingOnLoad();</script> <!-- Build Date UTC : 2021-04-02 22:10:49.325120+00:00 --> </body> </html>