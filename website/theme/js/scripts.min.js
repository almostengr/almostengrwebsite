function getHeaders(){return{"Content-Type":"application/json"}}async function submitJukeboxRequest(){const e=document.getElementById("alertBody"),t=document.getElementById("alertText"),n=document.getElementById("jukeboxForm"),s=new FormData(n),a=Object.fromEntries(s);try{if(e.classList.add(dNone),-1!==songNameElement.innerText.indexOf(showOfflineMessage))throw new Error("The show is offline and not accepting requests.");const n=await fetch(jukeboxRoute,{method:"POST",headers:getHeaders(),body:JSON.stringify(a)}),s=await n.json();if(n.status>299)throw new Error(s.message);t.innerText=s.message,e.classList.remove(dangerClass),e.classList.add(successClass)}catch(n){t.innerText=n,e.classList.remove(successClass),e.classList.add(dangerClass)}e.classList.remove(dNone)}async function getAllSettings(){if(null==songNameElement)return;const e="text-danger";try{const t=await fetch(jukeboxRoute,{method:"GET",headers:getHeaders()});if(t.status>299)throw new Error(n.message);const n=await t.json(),s=document.getElementById("currentArtist"),a=document.getElementById("controllerTemp"),o=document.getElementById("nwsTemp"),r=document.getElementById("songQueue"),l=document.getElementById("windchill");n.forEach(e=>{let t=32,n=0;switch(e.identifier){case"currentsong":var i=e.value.split("|");songNameElement.innerText=""==i[0]?showOfflineMessage:i[0],s.innerText=null==i[1]?"":i[1];break;case"cputempc":t=getFahrenheitFromCelsius(e.value),n=roundCelsius(e.value),a.innerText=`${t} F (${n} C)`;break;case"nwstempc":t=getFahrenheitFromCelsius(e.value),n=roundCelsius(e.value),o.innerText=`${t} F (${n} C)`;break;case"queuecount":r.innerText=""==s.innerText?0:e.value;break;case"windchill":t=getFahrenheitFromCelsius(e.value),n=roundCelsius(e.value),l.innerText=""==e.value?"None":`${t} F (${n} C)`}}),songNameElement.classList.remove(e)}catch(t){songNameElement.innerText=t,songNameElement.classList.add(e)}const t=7e3;setTimeout(getAllSettings,t)}function getFahrenheitFromCelsius(e){const t=parseFloat(e),n=1.8*t+32;return Math.round(n)}function roundCelsius(e){const t=parseFloat(e);return Math.round(t)}const jukeboxRoute="/jukeboxapi.php",successClass="alert-success",dangerClass="alert-danger",dNone="d-none",songNameElement=document.getElementById("currentSong"),showOfflineMessage="Show is offline";getAllSettings();